<UserControl x:Class="MCM6000_UI.controls.stepper"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:MCM6000_UI.controls"
      xmlns:conv="clr-namespace:MCM6000_UI.converters"
      mc:Ignorable="d" 
      d:DesignHeight="168"
      d:DesignWidth="590"
      d:DataContext="local:stepper">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ThemeControl;component/ThorStyleDark.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <!--Used for populating combobox in system tabs for device id's-->
            <XmlDataProvider x:Key="Device_id_XmlData"/>
            <Style TargetType="RadioButton">
                <Setter Property="Foreground" Value="White" />
            </Style>
            <conv:RadioButtonIsChecked x:Key="rb_conv" />
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <ContentControl Grid.Row="0" x:Name="e_ccl_header" />
        <Grid Grid.Row="1" x:Name="e_grd_top" Visibility="Visible">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="38" />
                    <ColumnDefinition Width="38" />
                </Grid.ColumnDefinitions>
                <Button Content="Settings" Grid.Row="0" Grid.Column="0" Margin="5,5,5,5" Click="Button_OpenSettings_Clicked" />
                <Label Content="CCW" Grid.Row="0" Grid.Column="1" />
                <Label Content="CW" Grid.Row="0" Grid.Column="2" />
                <Label Content="Moving" Grid.Row="1" />
                <Label Content="Hard Limit" Grid.Row="2" />
                <Label Content="Soft Limit" Grid.Row="3" />
                <RadioButton Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding MovingCCW, Mode=OneWay}" />
                <RadioButton Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding MovingCW, Mode=OneWay}" />
                <RadioButton Grid.Row="2" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding HardLimitCCW, Mode=OneWay}" />
                <RadioButton Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding HardLimitCW, Mode=OneWay}" />
                <RadioButton Grid.Row="3" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SoftLimitCCW, Mode=OneWay}" />
                <RadioButton Grid.Row="3" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SoftLimitCW, Mode=OneWay}" />

                <Button Grid.Row="4" Grid.Column="0" Content="Clear Soft" Margin="2,2,2,2" IsEnabled="{Binding ControlsEnabled}" Click="Button_ClearSoftLimits_Clicked" />
                <Button Grid.Row="4" Grid.Column="1" Content="Set" Margin="2,2,2,2" IsEnabled="{Binding ControlsEnabled}" Click="Button_SetCCWSoftLimits_Clicked" />
                <Button Grid.Row="4" Grid.Column="2" Content="Set" Margin="2,2,2,2" IsEnabled="{Binding ControlsEnabled}" Click="Button_SetCWSoftLimits_Clicked" />
            </Grid>
            <Grid Grid.Row="1" Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition MaxHeight="5" MinHeight="0" />
                    <RowDefinition Height="auto" />
                    <RowDefinition MaxHeight="5" MinHeight="0" />
                    <RowDefinition Height="auto" />
                    <RowDefinition MaxHeight="5" MinHeight="0" />
                    <RowDefinition Height="auto" />
                    <RowDefinition MaxHeight="5" MinHeight="0" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="45" />
                    <ColumnDefinition Width="45" />
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>
                <Button Grid.Row="0" Content="ᐱ" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" PreviewMouseDown="Button_MoveCWFast_Down" PreviewMouseUp="Button_MoveDir_Up" PreviewTouchDown="Button_MoveCWFast_Down" PreviewTouchUp="Button_MoveDir_Up" />
                <Button Grid.Row="2" Content="˄" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" PreviewMouseDown="Button_MoveCWSlow_Down" PreviewMouseUp="Button_MoveDir_Up" PreviewTouchDown="Button_MoveCWSlow_Down" PreviewTouchUp="Button_MoveDir_Up" />
                <Label Grid.Row="4" Content="Move" HorizontalAlignment="Center"/>
                <Button Grid.Row="6" Content="˅" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" PreviewMouseDown="Button_MoveCCWSlow_Down" PreviewMouseUp="Button_MoveDir_Up" PreviewTouchDown="Button_MoveCCWSlow_Down" PreviewTouchUp="Button_MoveDir_Up" />
                <Button Grid.Row="8" Content="ᐯ" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" PreviewMouseDown="Button_MoveCCWFast_Down" PreviewMouseUp="Button_MoveDir_Up" PreviewTouchDown="Button_MoveCCWFast_Down" PreviewTouchUp="Button_MoveDir_Up" />

                <Button Grid.Row="0" Grid.Column="1" Content="ᐱ" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" Click="Button_JogCW_Clicked" />
                <Label Grid.Row="4" Grid.Column="1" Content="Jog" HorizontalAlignment="Center" />
                <Button Grid.Row="8" Grid.Column="1" Content="ᐯ" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" Click="Button_JogCCW_Clicked" />

                <Button Grid.Row="0" Grid.Column="2" Content="Home" Margin="2,0,2,0" IsEnabled="{Binding ControlsEnabled}" Click="Button_Home_Clicked" />
                <RadioButton Grid.Row="4" Grid.Column="2" Content="Not Homed" Margin="0,0,2,0" IsChecked="{Binding NotHomed, Mode=OneWay}" />
                <RadioButton Grid.Row="6" Grid.Column="2" Content="Homing" Margin="0,0,2,0" IsChecked="{Binding Homing, Mode=OneWay}" />
                <RadioButton Grid.Row="8" Grid.Column="2" Content="Homed" Margin="0,0,2,0" IsChecked="{Binding Homed, Mode=OneWay}" />

            </Grid>
            <Grid Grid.Row="1" Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Content="{Binding ControlToggle}" Click="Button_StageEnabled_Clicked" />
                    <Button Content="Stop" Grid.Column="2" IsEnabled="{Binding ControlsEnabled}" Click="Button_Stop_Clicked" />
                    <Button Content="Zero" Grid.Column="4" IsEnabled="{Binding ControlsEnabled}" Click="Button_Zero_Clicked" />
                </Grid>
                <Grid Grid.Row="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Content="{Binding UnitString}" ContentStringFormat="Goto ({0})"
                            d:Content="µm"
                            IsEnabled="{Binding ControlsEnabled}" Click="Button_Goto_Clicked" />
                    <TextBox x:Name="e_tbx_goto" Grid.Column="2" Text="0" />
                </Grid>
                <Grid Grid.Row="4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Content="{Binding UnitString}" ContentStringFormat="Move By {0})"
                            d:Content="µm"
                            IsEnabled="{Binding ControlsEnabled}" Click="Button_MoveBy_Clicked" />
                    <TextBox x:Name="e_tbx_move_by" Grid.Column="2" Text="0" />
                </Grid>
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Label Content="{Binding UnitString}" ContentStringFormat="Encoder ({0}):" 
                           d:Content="µm:"/>
                    <TextBox Text="{Binding EncoderPosition, Mode=OneWay}" Grid.Column="1" Margin="2,2,2,2" ToolTip="{Binding EncoderToolTip, Mode=OneWay}"/>
                </Grid>
                <StackPanel Orientation="Horizontal" Grid.Row="1">
                    <Label Content="{Binding UnitString}" ContentStringFormat="Step Position ({0}):"
                           d:Content="µm" />
                    <Label Content="{Binding StepperPosition, Mode=OneWay}" />
                </StackPanel>
            </Grid>
            <Grid Grid.Row="1" Grid.Column="6">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Label Content="Saved Positions" HorizontalAlignment="Center"/>
                <UniformGrid Grid.Row="1">
                    <Border x:Name="e_brd_stored_pos_1" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="1" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                    <Border x:Name="e_brd_stored_pos_2" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="2" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                    <Border x:Name="e_brd_stored_pos_3" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="3" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                    <Border x:Name="e_brd_stored_pos_4" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="4" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                    <Border x:Name="e_brd_stored_pos_5" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="5" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                    <Border x:Name="e_brd_stored_pos_6" Margin="2,2,2,2" BorderThickness="3">
                        <Button Content="6" IsEnabled="{Binding ControlsEnabled}" Click="Button_GotoSavedPosition_Clicked" />
                    </Border>
                </UniformGrid>
            </Grid>
        </Grid>
        <Grid Grid.Row="1" x:Name="e_grd_settings" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" /> <!--Back Bar -->
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" /> <!--Saved Positions-->
            </Grid.ColumnDefinitions>
            
            <!--Back Bar-->
            <Button Grid.Column="0" Content="&lt;Back" Margin="0,5,0,5" Foreground="Red" Click="Button_CloseSettings_Clicked"/>
            
            <!--Configuration Entires-->
            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                
                <!--Left Options (connection independent)-->
                <Grid Grid.Column="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    
                    <!--Speed sliders-->
                    <Label Grid.Row="0" Grid.Column="0" Content="Move (fast, slow)" FontSize="10" />
                    <Slider Grid.Row="1" Grid.ColumnSpan="2" Value="{Binding FastMovePercentage, Mode=TwoWay}" Margin="0,0,0,5" Minimum="1" Maximum="100" SmallChange="1" />
                    <Slider Grid.Row="2" Grid.ColumnSpan="2" Value="{Binding SlowMovePercentage, Mode=TwoWay}" Margin="0,0,0,5" Minimum="1" Maximum="100" SmallChange="1" />

                    <!--Stop Mode-->
                    <StackPanel Grid.Row="3" Grid.Column="0">
                        <Label Content="Stop Mode:" FontSize="8" />
                        <RadioButton Content="Default" FontSize="10" IsChecked="{Binding StopMode, Converter={StaticResource rb_conv}, ConverterParameter={x:Static local:StepperStopMode.Default}}"
                                     GroupName="Group_StopMode" IsEnabled="{Binding IsSoftStopFeatureEnabled}" 
                                     ToolTipService.ShowOnDisabled="True">
                            <RadioButton.ToolTip>
                                Added in firmware version 7.2.1.
                            </RadioButton.ToolTip>
                        </RadioButton>
                    </StackPanel>
                    <StackPanel Grid.Row="3" Grid.Column="1">
                        <RadioButton Content="Hard" FontSize="10" IsChecked="{Binding StopMode, Converter={StaticResource rb_conv}, ConverterParameter={x:Static local:StepperStopMode.Hard}}"
                                     GroupName="Group_StopMode" />
                        <RadioButton Content="Soft" FontSize="10" IsChecked="{Binding StopMode, Converter={StaticResource rb_conv}, ConverterParameter={x:Static local:StepperStopMode.Soft}}"
                                     GroupName="Group_StopMode" IsEnabled="{Binding IsSoftStopFeatureEnabled}" 
                                     ToolTipService.ShowOnDisabled="True">
                            <RadioButton.ToolTip>
                                Added in firmware version 7.2.1.
                            </RadioButton.ToolTip>
                        </RadioButton>
                    </StackPanel>


                    <!--Movement Direction-->
                    <Label Grid.Row="5" Grid.Column="0" Content="Revered Dir." FontSize="10" />
                    <StackPanel Grid.Row="5" Grid.Column="1">
                        <RadioButton Content="Normal" FontSize="10" IsChecked="{Binding UIMoveDirection[0]}" GroupName="Group_MovementDirection" />
                        <RadioButton Content="Reversed" FontSize="10" IsChecked="{Binding UIMoveDirection[1]}" GroupName="Group_MovementDirection" />
                    </StackPanel>
                </Grid>
                
                <!--Right Options (require connection)-->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <!--Jog Step Size-->
                    <Button Grid.Row="0" Grid.Column="0" IsEnabled="{Binding ControlsEnabled}" Click="Button_JogSize_Clicked" 
                            Content="{Binding UnitString}" ContentStringFormat="Jog Step ({0})" d:Content="µm"
                            Margin="5,5,5,5"/>
                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="e_tbx_jog_step_size" Text="0" Margin="5,5,5,5" />
                    
                    <!--Jog Step Speed-->
                    <Button Grid.Row="1" Grid.Column="0" Content="Jog Speed (%)" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Click="Button_JogSpeed_Clicked" 
                            Margin="5,5,5,5"/>
                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="e_tbx_jog_step_speed" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Text="0" Margin="5,5,5,5" />
                    
                    <!--Goto Speed-->
                    <Button Grid.Row="2" Grid.Column="0" Content="Goto Speed (%)" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Click="Button_AbsoluteSpeed_Clicked" 
                            Margin="5,5,5,5"/>
                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="e_tbx_absolute_speed" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Text="0" Margin="5,5,5,5" />
                    
                    <!--Move By Speed-->
                    <Button Grid.Row="3" Grid.Column="0" Content="Rel. Speed (%)" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Click="Button_RelativeSpeed_Clicked" 
                            Margin="5,5,5,5"/>
                    <TextBox Grid.Row="3" Grid.Column="1" x:Name="e_tbx_relative_speed" IsEnabled="{Binding IsSpeedFeaturesEnabled}" Text="0" Margin="5,5,5,5" />
                </Grid>
            </Grid>
            
            <!--Saved Positions-->
            <Border Grid.Column="2" BorderBrush="White">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <Label Grid.Row="0" Content="Saved Positions" />
                    <UniformGrid Grid.Row="1" Rows="2">
                        <Border x:Name="e_brd_conf_saved_pos_1" Margin="2,2,2,2">
                            <Button Content="1" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        <Border x:Name="e_brd_conf_saved_pos_2" Margin="2,2,2,2">
                            <Button Content="2" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        <Border x:Name="e_brd_conf_saved_pos_3" Margin="2,2,2,2">
                            <Button Content="3" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        <Border x:Name="e_brd_conf_saved_pos_4" Margin="2,2,2,2">
                            <Button Content="4" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        <Border x:Name="e_brd_conf_saved_pos_5" Margin="2,2,2,2">
                            <Button Content="5" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        <Border x:Name="e_brd_conf_saved_pos_6" Margin="2,2,2,2">
                            <Button Content="6" IsEnabled="{Binding ControlsEnabled}" Click="Button_SelectSetSavedPos_Clicked" />
                        </Border>
                        
                    </UniformGrid>
                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>

                        <Button Grid.Row="0" Grid.Column="0" Content="Clear" Margin="3,3,3,3" IsEnabled="{Binding ControlsEnabled}" Click="Button_ClearSavedPos_Clicked" />
                        <Button Grid.Row="0" Grid.Column="1" Content="Set" Margin="3,3,3,3" IsEnabled="{Binding ControlsEnabled}" Click="Button_SetSavedPos_Clicked" />
                        <Button Grid.Row="0" Grid.Column="2" Content="Copy Pos" Margin="3,3,3,3" IsEnabled="{Binding ControlsEnabled}" Click="Button_CopySavedPos_Clicked" />
                        <Button Grid.Row="0" Grid.Column="3" Content="Save All" Margin="15,3,3,3" IsEnabled="{Binding ControlsEnabled}" Click="Button_SaveSavedPos_Clicked" />
                        <TextBox Grid.Row="1" Grid.ColumnSpan="4" x:Name="e_tbx_set_saved_position" Text="0" Margin="2,2,2,2"/>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>
