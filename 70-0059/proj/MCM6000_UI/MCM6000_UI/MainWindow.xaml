<Window x:Class="MCM6000_UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MCM6000_UI"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:s="http://schemas.abtsoftware.co.uk/scichart"
        xmlns:builders="clr-namespace:MCM6000_UI.builders"
        xmlns:controls="clr-namespace:MCM6000_UI.controls"
        mc:Ignorable="d"
        Title="MCM301 UI" Height="830" Width="1200" ResizeMode="CanResize" WindowStartupLocation="CenterScreen" WindowState="Normal" SizeToContent="WidthAndHeight" >
    <Window.Resources>
        <ResourceDictionary>
            <!-- <Style TargetType="{x:Type Button}">
                <Setter Property="Stylus.IsPressAndHoldEnabled" Value="False"/>
             
            </Style> -->
            <!--<Style TargetType="{x:Type Button}">
                <Setter Property="Foreground" Value="Green" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Foreground" Value="Red" />
                    </Trigger>
                    <Trigger Property="Selector.IsSelected" Value="True">
                        <Setter Property="Foreground" Value="Red" />
                    </Trigger>
                </Style.Triggers>
            </Style>
            <Style TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}">
                                <ContentPresenter
                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Border>
                            
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="BLUE"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="GREEN"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="RED"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Foreground" Value="White" />
                
            </Style>-->
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ThemeControl;component/ThorStyleDark.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <!--Used for populating combobox in system tabs for device id's-->
            <XmlDataProvider x:Key="Device_id_XmlData"/>
            <DataTemplate DataType="{x:Type builders:OneWireV2BuilderViewModel}">
                <controls:OneWireConfigurationV2 />
            </DataTemplate>
            <DataTemplate DataType="{x:Type builders:OneToOneViewModel}">
                <controls:OneWireCabling />
            </DataTemplate>
            <DataTemplate DataType="{x:Type builders:OneWireSystemViewModel}">
                <controls:OneWireSystem />
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="62*"/>
            <ColumnDefinition Width="537*"/>
        </Grid.ColumnDefinitions>
        <StackPanel Grid.ColumnSpan="2">
            <StackPanel Margin="5" Orientation="Horizontal">
                <!-- This menu is needed for the tablet touchsreen so that the buttons don't stay focused-->
                <Menu Width="0" Height="0">
                    <MenuItem Header="Menu" FontSize="18." Width="0" Height="0">
                    </MenuItem>
                </Menu>
                <Label x:Name="lbl_hardware_info" Content="Firmware Rev:" Width="550" FontSize="11" VerticalContentAlignment="Center" />
                <Label x:Name="lbl_con_status" Content="Connection Status"  Width="250" />
                <Button Content="Diagnostics" Margin="5,5,5,5" Click="Button_Diag_Clicked" Width="70"/>
                <Button x:Name="e_btn_boardIdentify" Content="Identify" Margin="5,5,5,5" Click="Button_Identify_Clicked" />
                <TextBox Name="tbx_password" Text="" Width="50" KeyUp="tbx_password_KeyUp"/>
                <Button Content="Quit" Width="50"  Margin="5,5,5,5" Click="Button_Click"/>
                <Image Width="140" Source="Thorlabs.png" MouseDown="Image_MouseDown" >
                </Image>
            </StackPanel>
            <TabControl x:Name="MCM6000_tabs" MinHeight="729" SelectionChanged="MCM6000_tabs_SelectionChanged" Width="1200">
                <TabItem x:Name="ControlTab" Header="Control">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">

                            <Border Name="_slot_1" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_1"/>
                            </Border>

                            <Border Name="_slot_2" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_2"/>
                            </Border>

                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Border Name="_slot_3" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_3"/>
                            </Border>

                            <Border Name="_slot_4" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_4"/>
                            </Border>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Border Name="_slot_5" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_5"/>
                            </Border>

                            <Border Name="_slot_6" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_6"/>
                            </Border>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Border Name="_slot_7" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_7"/>
                            </Border>

                            <Border Name="_slot_8" Margin="2,2,0,0" Height="172" Width="594" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <ContentControl Name="brd_slot_8"/>
                            </Border>

                        </StackPanel>

                    </StackPanel>
                </TabItem>

                <TabItem x:Name="MesoTab" Header="Mesoscope" >
                    <StackPanel>
                        <StackPanel Orientation="Vertical">
                            <StackPanel Orientation="Horizontal">
                                <Button x:Name="btnToggle_Block_Meso" Content="Block Buttons" FontSize="20" Height="40" Margin="5,10,0,10" Width="160" Click="btnToggle_Block_Goto_Click"/>
                                <Button x:Name="btnToggle_shutter" Content="Shutter Closed" FontSize="20" Height="40" Margin="680,10,0,10" Width="160" Click="btnToggle_shutter_Click"/>
                                <Button x:Name="btnToggle_smirror" Content="Mirror Closed" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnToggle_mirror_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Button x:Name="btnSet_Goto_1" Content="Set Mark 1" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnSet_Mark_Click"/>
                                <Button x:Name="btnSet_Goto_2" Content="Set Mark 2" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnSet_Mark_Click"/>
                                <Button x:Name="btnSet_Goto_3" Content="Set Mark 3" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnSet_Mark_Click"/>
                                <Button x:Name="btnGoto_1" Content="Goto Mark 1" FontSize="20" Height="40" Margin="170,10,0,10" Width="160" Click="btnGoto_Mark_Click"/>
                                <Button x:Name="btnGoto_2" Content="Goto Mark 2" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnGoto_Mark_Click"/>
                                <Button x:Name="btnGoto_3" Content="Goto Mark 3" FontSize="20" Height="40" Margin="10,10,0,10" Width="160" Click="btnGoto_Mark_Click"/>
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Border Name="_meso_border_1" Margin="2,2,0,0" Height="275" Width="592" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <StackPanel Name="sp_meso_1" Orientation="Vertical">
                                    <StackPanel Orientation="Horizontal">
                                        <Label Name="meso_x_lb" HorizontalContentAlignment="Center" Padding="0" Content="X" Background="#FF3A3B3C" FontSize="70" Margin="5,5,0,5" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="65"/>
                                        <TextBox Name="lblXPos" TextAlignment="Right" Text="0000.0" FontSize="70" Margin="5,5,5,0" Height="80" VerticalAlignment="Top" Width="390" HorizontalAlignment="Right"/>
                                        <Label HorizontalContentAlignment="Center" Content="um" FontSize="14" Margin="0,0,0,0" Height="40" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="30"/>
                                        <Button x:Name="btnZero_1" Content="Zero" FontSize="20" Height="80" Margin="0,3,5,1" Width="80" Click="btnMeso_Zero_Click"/>

                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton Name="rd_CCW_limit_X" Content="CCW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_limit_X" Content="CW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CCW_moving_X" Content="CCW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_moving_X" Content="CW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CCW_limit_X" Content="CCW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CW_limit_X" Content="CW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Content="Mark 1:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_x1" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 2:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_x2" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 3:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_x3" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_softlim_1" Content="Set CCW Soft Lim" FontSize="20" Height="50" Margin="20,2,0,2" Width="160" Click="btn_set_ccw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_CW_softlim_1" Content="Set CW Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_set_cw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_clear_softlim_1" Content="Clear Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_clear_soft_lim_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_F_1" Content="&lt;&lt;" FontSize="20" Height="35" Margin="50,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave" IsTabStop="False"/>
                                        <Button x:Name="btnMeso_CCW_S_1" Content="&lt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_S_1" Content="&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_F_1" Content="&gt;&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <Border Name="_meso_border_2" Margin="2,2,0,0" Height="275" Width="592" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <StackPanel Name="sp_meso_2" Orientation="Vertical">
                                    <StackPanel Orientation="Horizontal">
                                        <Label Name="meso_y_lb" HorizontalContentAlignment="Center" Padding="0" Content="Y" Background="#FF3A3B3C" FontSize="70" Margin="5,5,0,5" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="65"/>
                                        <TextBox Name="lblYPos" TextAlignment="Right" Text="0000.0" FontSize="70" Margin="5,5,5,0" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="390"/>
                                        <Label HorizontalContentAlignment="Center" Content="um" FontSize="14" Margin="0,0,0,0" Height="40" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="30"/>
                                        <Button x:Name="btnZero_2" Content="Zero" FontSize="20" Height="80" Margin="0,3,5,1" Width="80" Click="btnMeso_Zero_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton Name="rd_CCW_limit_Y" Content="CCW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_limit_Y" Content="CW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CCW_moving_Y" Content="CCW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_moving_Y" Content="CW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CCW_limit_Y" Content="CCW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CW_limit_Y" Content="CW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Content="Mark 1:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_y1" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 2:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_y2" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 3:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_y3" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_softlim_2" Content="Set CCW Soft Lim" FontSize="20" Height="50" Margin="20,2,0,2" Width="160" Click="btn_set_ccw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_CW_softlim_2" Content="Set CW Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_set_cw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_clear_softlim_2" Content="Clear Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_clear_soft_lim_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_F_2" Content="&lt;&lt;" FontSize="20" Height="35" Margin="50
                                                ,10,0,2" Width="120" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CCW_S_2" Content="&lt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_S_2" Content="&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_F_2" Content="&gt;&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Border Name="_meso_border_4" Margin="2,2,0,0" Height="275" Width="592" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <StackPanel Name="sp_meso_4" Orientation="Vertical">
                                    <StackPanel Orientation="Horizontal">
                                        <Label Name="meso_r_lb" HorizontalContentAlignment="Center"  Padding="0" Content="R" Background="#FF3A3B3C" FontSize="70" Margin="5,5,0,5" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="65"/>
                                        <TextBox Name="lblRPos" TextAlignment="Right" Text="000.000" FontSize="70" Margin="5,5,5,0" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="390"/>
                                        <Label HorizontalContentAlignment="Center" Content="deg" FontSize="14" Margin="-4,0,0,0" Height="40" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="34"/>
                                        <Button x:Name="btnZero_4" Content="Zero" FontSize="20" Height="80" Margin="0,3,5,1" Width="80" Click="btnMeso_Zero_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton Name="rd_CCW_limit_R" Content="CCW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_limit_R" Content="CW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CCW_moving_R" Content="CCW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_moving_R" Content="CW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CCW_limit_R" Content="CCW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CW_limit_R" Content="CW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Content="Mark 1:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_r1" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 2:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_r2" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 3:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_r3" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_softlim_4" Content="Set CCW Soft Lim" FontSize="20" Height="50" Margin="20,2,0,2" Width="160" Click="btn_set_ccw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_CW_softlim_4" Content="Set CW Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_set_cw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_clear_softlim_4" Content="Clear Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_clear_soft_lim_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_F_4" Content="&lt;&lt;" FontSize="20" Height="35" Margin="50,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CCW_S_4" Content="&lt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_S_4" Content="&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_F_4" Content="&gt;&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border Name="_meso_border_3" Margin="2,2,0,0" Height="275" Width="592" HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="White" BorderThickness="2" >
                                <StackPanel Name="sp_meso_3" Orientation="Vertical">
                                    <StackPanel Orientation="Horizontal">
                                        <Label Name="meso_z_lb" HorizontalContentAlignment="Center" Padding="0" Content="Z" Background="#FF3A3B3C" FontSize="70" Margin="5,5,0,5" Height="80" VerticalAlignment="Center" HorizontalAlignment="Left" Width="65">
                                            <Label.RenderTransform>
                                                <TransformGroup>
                                                    <ScaleTransform/>
                                                    <SkewTransform/>
                                                    <RotateTransform/>
                                                    <TranslateTransform/>
                                                </TransformGroup>
                                            </Label.RenderTransform>
                                        </Label>
                                        <TextBox Name="lblZPos" TextAlignment="Right" Text="0000.0" FontSize="70" Margin="5,5,5,0" Height="80" VerticalAlignment="Top" HorizontalAlignment="Left" Width="390" />
                                        <Label HorizontalContentAlignment="Center" Content="um" FontSize="14" Margin="0,0,0,0" Height="40" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="30"/>
                                        <Button x:Name="btnZero_3" Content="Zero" FontSize="20" Height="80" Margin="0,3,5,1" Width="80" Click="btnMeso_Zero_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton Name="rd_CCW_limit_Z" Content="CCW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_limit_Z" Content="CW Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CCW_moving_Z" Content="CCW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_CW_moving_Z" Content="CW Moving" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CCW_limit_Z" Content="CCW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                        <RadioButton Name="rd_meso_CW_limit_Z" Content="CW Soft Limit" Foreground="White" Margin="5, 5, 5, 5"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Content="Mark 1:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_z1" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 2:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_z2" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                        <Label Content="Mark 3:" FontSize="18" Margin="5,0,0,0" Width="80"/>
                                        <Label Name="lb_mark_z3" Content="0000.000" FontSize="18" Margin="0,0,0,0" Width="100"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_softlim_3" Content="Set CCW Soft Lim" FontSize="20" Height="50" Margin="20,2,0,2" Width="160" Click="btn_set_ccw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_CW_softlim_3" Content="Set CW Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_set_cw_soft_lim_Click"/>
                                        <Button x:Name="btnMeso_clear_softlim_3" Content="Clear Soft Lim" FontSize="20" Height="50" Margin="35,2,0,2" Width="160" Click="btn_clear_soft_lim_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="btnMeso_CCW_F_3" Content="&lt;&lt;" FontSize="20" Height="35" Margin="50,10,0,2" Width="120" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CCW_S_3" Content="&lt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_S_3" Content="&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                        <Button x:Name="btnMeso_CW_F_3" Content="&gt;&gt;" FontSize="20" Height="35" Margin="20,10,0,2" Width="100" Stylus.IsPressAndHoldEnabled="False"
                                                PreviewMouseLeftButtonDown="btn_Velocity_Move_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="btn_Velocity_Move_PreviewMouseLeftButtonUp" 
                                                PreviewTouchDown="btn_Velocity_Move_PreviewTouchDown" PreviewTouchUp="btn_Velocity_Move_PreviewTouchUp" Click="btn_velocity_move_Click" TouchLeave="btn_Velocity_Move_TouchLeave"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </TabItem>

                <TabItem x:Name="Log_tab" Header="Log">
                    <StackPanel Orientation="Horizontal">
                        <RichTextBox Name="rtb_log" Margin="15,15,15,15" Width="1050" VerticalScrollBarVisibility="Auto" FontFamily="Consolas" FontSize="11" Block.LineHeight="6" HorizontalScrollBarVisibility="Auto">
                            <FlowDocument PageWidth="2048"></FlowDocument>
                        </RichTextBox>
                        <StackPanel Orientation="Vertical">
                            <Button x:Name="btRefresh_log_file" Content="Refresh" Height="30" Margin="5,20,0,5" Width="80" Click="btRefresh_log_file_Click" />
                            <Button x:Name="btOpen_log_file" Content="Open" Height="30" Margin="5,5,0,35" Width="80" Click="btOpen_log_file_Click" />
                            <Label Content="Search Text" HorizontalAlignment="Center"/>
                            <TextBox x:Name="tb_search_log" Text="ERROR" Width="100" Margin="5,5,5,5" />
                            <Button x:Name="btSearch_up_log_file" Content="Search Up" Height="30" Margin="5,5,0,5" Width="80" Click="btSearch_up_log_file_Click"/>
                            <Button x:Name="btSearch_down_log_file" Content="Search Down" Height="30" Margin="5,5,0,5" Width="80" Click="btSearch_down_log_file_Click"/>
                            <Button x:Name="btSearch_All_log_file" Content="Search All" Height="30" Margin="5,5,0,5" Width="80" Click="bnt_Search_All_Click"/>
                            <Label x:Name="lb_log_results" Margin="5,5,0,5" Width="100" Content="" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>

                </TabItem>

                <TabItem x:Name="hexapod_tab" Header="Hexapod" RenderTransformOrigin="-5.194,0.538">
                    <StackPanel Orientation="Horizontal">
                        <StackPanel Name="StagePosition" Orientation="Vertical" Width="310" HorizontalAlignment="Left">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="65">
                                <Label Content="Stage Pose" FontSize="36" Margin="60, 0, 0, 0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="X " FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStageX" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Âµm" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="Y " FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStageY" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Âµm" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="Z " FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStageZ" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Âµm" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="Î˜" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStageTheta" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Â°" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="Î¦" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStagePhi" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Â°" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" Height="55">
                                <Label Content="Î¨" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="10, 0, 0, 0"/>
                                <TextBox  x:Name="tbStagePsi" FontSize="24" Margin="10,0,0,0" HorizontalAlignment="Left" HorizontalContentAlignment="Right" Width="164" Height="50" VerticalAlignment="Center"/>
                                <Label Content="Â°" FontSize="24" HorizontalAlignment="Center" Height="45" Margin="15,0,0,0" />
                            </StackPanel>
                            <TextBlock Margin="10,10,10,10" Foreground="White" TextWrapping="Wrap" Text="Rotation angles use the Tait-Bryan notation.  Stewart Platforms are commonly used in flight simulators so the roll (Î¦), pitch(Î˜), yaw(Î¨) style of denoting the rotation transform is often used when describing the position." />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Height="100" VerticalAlignment="Top">
                            <StackPanel Orientation="Vertical" Width="100">
                                <Label x:Name="lblKp" Content="xxx" FontSize="18" HorizontalAlignment="Center"/>
                                <TextBox x:Name="tbKp" FontSize="18" Text="100" Height="35" HorizontalAlignment="Center" Width="80"/>
                                <Button x:Name="btnKp" Content="Set Kp" FontSize="18" Click="btnKp_Click"/>
                            </StackPanel>
                            <StackPanel Width="10"/>
                            <StackPanel Orientation="Vertical" Width="100">
                                <Label x:Name="lblKi" Content="xxx" FontSize="18" HorizontalAlignment="Center"/>
                                <TextBox x:Name="tbKi" FontSize="18" Text="100" Height="35" HorizontalAlignment="Center" Width="80"/>
                                <Button x:Name="btnKi" Content="Set Ki" FontSize="18" Click="btnKi_Click"/>
                            </StackPanel>
                            <StackPanel Width="10"/>
                            <StackPanel Orientation="Vertical" Width="100">
                                <Label x:Name="lblKd" Content="xxx" FontSize="18" HorizontalAlignment="Center"/>
                                <TextBox x:Name="tbKd" FontSize="18" Text="100" Height="35" HorizontalAlignment="Center" Width="80"/>
                                <Button x:Name="btnKd" Content="Set Kd" FontSize="18" Click="btnKd_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical" Width="100">
                                <Label x:Name="lbliMax" Content="xxx" FontSize="18" HorizontalAlignment="Center"/>
                                <TextBox x:Name="tbiMax" FontSize="18" Text="1000000" Height="35" HorizontalAlignment="Center" Width="80"/>
                                <Button x:Name="btniMax" Content="Set iMax" FontSize="18" Click="btnKd_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical" Width="100">
                                <TextBox x:Name="tbHexJog" Text="1" FontSize="18" Height="35" HorizontalAlignment="Center" Width="80"/>
                                <Button x:Name="btnHexJogUp" Content="Jog Up" FontSize="18" Click="btnHexJogUp_Click"/>
                                <Button x:Name="bntnHexJogDwn" Content="Jog Down" FontSize="18" Click="btnHexJogDwn_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="vritual_motion" Header="Motion" Margin="-3,0,3,0">
                    <StackPanel>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ Synchonized Motion Config ]"/>
                                    <Button x:Name="bt_sm_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_sm_params_refresh_Click"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Type"/>
                                    <ComboBox Name="cb_synchonized_motion_type_select" Margin="15,5,5,5" SelectedIndex="0">
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Axis" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Plane" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Hexapod" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Slot for X"/>
                                    <ComboBox Name="cb_synchonized_motion_select_x" Margin="15,5,5,5" SelectedIndex="0">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Slot for Y"/>
                                    <ComboBox Name="cb_synchonized_motion_select_y" Margin="15,5,5,5" SelectedIndex="1">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Slot for Z"/>
                                    <ComboBox Name="cb_synchonized_motion_select_z" Margin="15,5,5,5" SelectedIndex="2">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Speed(ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbsynchonizedMotionDelta" Text="100000" Width="115" Margin="5,5,5,5" ToolTip="This sets the max delta position per 10ms interval (Speed). A good starting point is 100000."></TextBox>
                                    <Button Name="btSavesynchonizedMotionParams" Content="Save"  Width="56" Margin="5,5,5,5" Click="btSavesynchonizedMotionParams_Click"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ Synchonized Motion Setup ]"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Button x:Name="btSmClearPoints" Content="Clear Points"  Width="150" Margin="5,5,5,5" Click="btSmClearPoints_Click" />
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Button x:Name="btSmSetP1" Content="Set First Point"  Width="150" Margin="5,5,5,5" Click="btSmSetPoint_Click" />
                                    <Button x:Name="btSmSetP2" Content="Set Second Point"  Width="150" Margin="5,5,5,5" Click="btSmSetPoint_Click" />
                                    <Button x:Name="btSmSetP3" Content="Set Third Point"  Width="150" Margin="5,5,5,5" Click="btSmSetPoint_Click"  />
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="stepper_log_tab" Header="Stepper Log" RenderTransformOrigin="-3.395,0.423" HorizontalAlignment="Left" >
                    <StackPanel>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <StackPanel Orientation="Horizontal" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot for Log info:"/>
                                    <ComboBox x:Name="log_slot_select" Margin="15,5,5,5" SelectionChanged="log_SelectionChanged" Width="200">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_params_refresh_Click"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>

                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ Slot PID Parameters ]"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Kp: " Margin="5,0,0,0"/>
                                    <TextBox x:Name="tb_p_term_s" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                    <Label Content="Ki: " Margin="5,0,0,0"/>
                                    <TextBox x:Name="tb_i_term_s" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                    <Label Content="Kd: " Margin="5,0,0,0"/>
                                    <TextBox x:Name="tb_d_term_s" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                    <Label Content="iMax: " Margin="5,0,0,0"/>
                                    <TextBox x:Name="tb_imax_s" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                    <Button x:Name="save_stepper_pid_params_s" Content="Save PID Parameters for Slot"  Width="180" Margin="5,5,5,5" Click="save_stepper_pid_params_s_Click" />
                                </WrapPanel>
                            </WrapPanel>
                        </Border>

                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <StackPanel Orientation="Horizontal" >
                                <StackPanel Orientation="Vertical" >
                                    <Label Content="Slot Actions:"/>
                                    <StackPanel Orientation="Horizontal" >
                                        <Button x:Name="btStepper_log_goto_1" Content="Goto"  Width="50 " Margin="5,5,5,5" Click="btnLog_Goto_Click" />
                                        <TextBox x:Name="tbStepper_log_goto_1" Text="0" Width="70" Margin="5,5,5,5"/>
                                        <Button x:Name="btStepper_p0" Content="P1"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p1" Content="P2"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p2" Content="P3"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p3" Content="P4"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p4" Content="P5"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p5" Content="P6"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p6" Content="P7"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p7" Content="P8"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p8" Content="P9"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />
                                        <Button x:Name="btStepper_p9" Content="P10"  Width="50 " Margin="5,5,5,5" Click="btn_goto_stored_position_log_Click" />

                                        <Button x:Name="Clear_Plot" Content="Clear Plot" Margin="100,5,5,5" Click="Clear_Plot_Click"/>
                                        <Label Content="Plot update interval (ms):"/>
                                        <TextBox x:Name="tb_log_interval" Text="10" Width="60" Margin="5,5,5,5" TextChanged="tb_log_interval_TextChanged" />
                                        <Button x:Name="Save_Plot" Content="Save Plot" Margin="5,5,5,5" Click="Save_Plot_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" >
                                        <Button x:Name="btStepper_log_move_by_1" Content="Move"  Width="50 " Margin="5,5,5,5" Click="btnLog_move_by_Click" />
                                        <TextBox x:Name="tbStepper_log_jog_1" Text="0" Width="70" Margin="5,5,5,5"/>
                                        <Label Content="Plot Scroll Size:" Margin="700,5,5,5"/>
                                        <Slider x:Name="sl_plot_scroll_size" Maximum="1000000"  Margin="5,5,5,5" SmallChange="10" TickFrequency="0" Value="40000" Minimum="10" ValueChanged="sl_plot_scroll_size_ValueChanged" LargeChange="100" Width="200"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <StackPanel>
                        </StackPanel>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <StackPanel>
                                <s:SciChartSurface Name="SciF" Height="450" Width="1150" Margin="0,0,0,0">
                                    <s:SciChartSurface.RenderableSeries>
                                        <s:FastLineRenderableSeries x:Name="LineSeries_cmd_pos_Series" YAxisId="enc"/>
                                        <s:FastLineRenderableSeries x:Name="LineSeries_enc_pos_Series" YAxisId="enc"/>
                                        
                                        <s:FastLineRenderableSeries x:Name="LineSeries_thermal_warn_Series" YAxisId="bool" />
                                        <s:FastLineRenderableSeries x:Name="LineSeries_thermal_shutdown_Series" YAxisId="bool" />
                                        <s:FastLineRenderableSeries x:Name="LineSeries_step_loss_Series" YAxisId="bool" />
                                        <s:FastLineRenderableSeries x:Name="LineSeries_ocd_Series" YAxisId="bool" />
                                    </s:SciChartSurface.RenderableSeries>
                                    <s:SciChartSurface.XAxis>
                                        <s:NumericAxis AxisTitle="Time (ms)" x:Name="xAxis">
                                        </s:NumericAxis>
                                    </s:SciChartSurface.XAxis>
                                    <s:SciChartSurface.YAxes>
                                        <s:NumericAxis AxisTitle="um" Id="enc" AxisAlignment="Left"/>
                                        <s:NumericAxis AxisTitle="bool" Id="bool" AxisAlignment="Right" VisibleRange="-0,1"/>
                                    </s:SciChartSurface.YAxes>
                                    <s:SciChartSurface.ChartModifier>
                                        <s:ModifierGroup>
                                            <!-- Allow drag to zoom on Left mouse -->
                                            <s:RubberBandXyZoomModifier ExecuteOn="MouseLeftButton"
                                                 RubberBandFill="#33FFFFFF" RubberBandStroke="#AAFFFFFF"
                                                 RubberBandStrokeDashArray="2 2"/>
                                            <!-- Allow pan on Right mouse drag -->
                                            <s:ZoomPanModifier ExecuteOn="MouseRightButton" ClipModeX="None" />
                                            <!-- Allow Dragging YAxis to Scale -->
                                            <s:YAxisDragModifier DragMode="Scale"/>
                                            <!-- Allow Dragging XAxis to Pan -->
                                            <s:XAxisDragModifier DragMode="Pan"/>
                                            <!-- Allow Mousewheel Zoom -->
                                            <s:MouseWheelZoomModifier/>
                                            <!-- Allow Zoom to Extents on double click -->
                                            <s:ZoomExtentsModifier ExecuteOn="MouseDoubleClick" />
                                            <!-- Add a Legend to the chart -->
                                            <!-- where xmlns:s="http://schemas.abtsoftware.co.uk/scichart" -->
                                            <s:LegendModifier Name="LogLeg" ShowLegend="True" Orientation="Vertical"
                                       VerticalAlignment="Top"                                     
                                       HorizontalAlignment="Left"
                                       LegendPlacement="Inside" />
                                            <!-- Add a RolloverModifier to the chart (shows vertical line tooltips -->
                                            <s:RolloverModifier IsEnabled="True" DrawVerticalLine="True" ShowTooltipOn="Always" SourceMode="AllSeries"/>
                                        </s:ModifierGroup>

                                    </s:SciChartSurface.ChartModifier>
                                </s:SciChartSurface>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem Name="USB_host" Header="USB Host">
                    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Height="750">
                        <StackPanel>
                            <StackPanel >
                                <StackPanel Orientation="Vertical">

                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="Refresh" Content="Refresh USB Ports"  Click="Refresh_Click" Margin="5,5,0,5"/>
                                                <Button x:Name="Clear_all_map" Content="Clear All Mapping"  Click="clear_all_Click" Margin="5,5,0,5"/>
                                                <Button x:Name="Save_all_map" Content="Save All Mapping"  Click="save_all_Click" Margin="5,5,0,5"/>
                                                <Button x:Name="Clear_all__in_map" Content="Clear All In Mapping"  Click="clear_all_in_Click" Margin="25,5,0,5"/>
                                                <Button x:Name="Clear_all__out_map" Content="Clear All Out Mapping"  Click="clear_all_out_Click" Margin="5,5,0,5"/>
                                                <CheckBox x:Name="e_chk_usb_host_top_save_to_eeprom" Content="Apply to EEPROM" Margin="50,5,0,5" />
                                            </WrapPanel>
                                        </WrapPanel>
                                    </Border>


                                    <Border  Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <StackPanel Orientation="Horizontal" >
                                            <StackPanel Orientation="Vertical" Width="120">
                                                <Label Content="Input Mapping"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Port"/>
                                                    <TextBox x:Name="in_add_port_num" Width="50" Text="0"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="VID "/>
                                                    <TextBox x:Name="add_VID" Width="50"  Text="0" ToolTip="0 for any HID device" TextChanged="add_VID_TextChanged"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="PID "/>
                                                    <TextBox x:Name="add_PID" Width="50"  Text="0" ToolTip="0 for any HID device" TextChanged="add_PID_TextChanged"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical" Width="220">
                                                <Label Content="Control Config"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Ctrl" Margin="0,0,3,0"/>
                                                    <TextBox x:Name="add_map_num" Width="50"  Text="0" ToolTip="Control number taken from HID data below" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal"  Margin="0,5,0,0">
                                                    <Label Content="Deadband" Margin="0,0,3,0"/>
                                                    <TextBox x:Name="tb_joystick_deadband" Width="50"  Text="0" ToolTip="0 to 255" />
                                                    <CheckBox x:Name="in_reverse_dir" Content="Reverse Dir" VerticalAlignment="Center" Margin="15,0,0,0"/>
                                                </StackPanel>
                                                <Label Content="High speed (% of stage maximum)" Margin="0,0,10,0"/>
                                                <Slider x:Name="m_high_speed" Minimum="0" Maximum="100" Value="100" Width="150"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                    <Label Content="Mode"/>
                                                    <ComboBox Name="map_add_mode" SelectedIndex="0">
                                                        <ComboBoxItem Content="Axis (D)"/>
                                                        <ComboBoxItem Content="Select (M+D)"/>
                                                        <ComboBoxItem Content="Select Toggle (M+D)"/>
                                                        <ComboBoxItem Content="Toggle Disable (M)"/>
                                                        <ComboBoxItem Content="Disable (M)"/>
                                                        <ComboBoxItem Content="Toggle Disable (D)"/>
                                                        <ComboBoxItem Content="Disable (D)"/>
                                                        <ComboBoxItem Content="Jog CW (D)"/>
                                                        <ComboBoxItem Content="Jog CCW (D)"/>
                                                        <ComboBoxItem Content="Toggle Position(D)"/>
                                                        <ComboBoxItem Content="Home(D)"/>
                                                        <ComboBoxItem Content="Position 1 (D)"/>
                                                        <ComboBoxItem Content="Position 2 (D)"/>
                                                        <ComboBoxItem Content="Position 3 (D)"/>
                                                        <ComboBoxItem Content="Position 4 (D)"/>
                                                        <ComboBoxItem Content="Position 5 (D)"/>
                                                        <ComboBoxItem Content="Position 6 (D)"/>
                                                        <ComboBoxItem Content="Position 7 (D)"/>
                                                        <ComboBoxItem Content="Position 8 (D)"/>
                                                        <ComboBoxItem Content="Position 9 (D)"/>
                                                        <ComboBoxItem Content="Position 10 (D)"/>
                                                        <ComboBoxItem Content="Speed Set(M+D)"/>
                                                        <ComboBoxItem Content="Speed Set Toggle(M+D)"/>
                                                        <ComboBoxItem/>
                                                    </ComboBox>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel Orientation="Vertical" Width="350">
                                                <Label Content="Modify Control"/>
                                                <Label Content="Port of the control to be targeted by this control"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_m_p_0" Content="P0" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_1" Content="P1" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_2" Content="P2" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_3" Content="P3" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_4" Content="P4" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_5" Content="P5" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_6" Content="P6" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_m_p_7" Content="P7" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                </StackPanel>
                                                <Label Content="Control Number of the control to be targeted for modification"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_m_cn_0" Content="C0" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_1" Content="C1" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_2" Content="C2" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_3" Content="C3" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_4" Content="C4" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_5" Content="C5" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_6" Content="C6" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_7" Content="C7" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_m_cn_8" Content="C8" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_9" Content="C9" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_m_cn_10" Content="C10" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <CheckBox x:Name="in_m_cn_11" Content="C11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <CheckBox x:Name="in_m_cn_12" Content="C12" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <CheckBox x:Name="in_m_cn_13" Content="C13" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <CheckBox x:Name="in_m_cn_14" Content="C14" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <CheckBox x:Name="in_m_cn_15" Content="C15" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical">
                                                <Label Content="Destination"/>
                                                <Label Content="Slot"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_d_s_0" Content="S0" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_1" Content="S1" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_2" Content="S2" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_3" Content="S3" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_4" Content="S4" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_5" Content="S5" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_6" Content="S6" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_s_7" Content="S7" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                </StackPanel>
                                                <Label Content="Bit (if a slot has multiple outputs like triggers or shutters)"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_d_b_0" Content="B0" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_1" Content="B1" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_2" Content="B2" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_3" Content="B3" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_4" Content="B4" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_5" Content="B5" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_6" Content="B6" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_b_7" Content="B7" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                </StackPanel>
                                                <Label Content="Port, Send data to USB devices connected to the controller"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="in_d_p_0" Content="P0" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_1" Content="P1" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_2" Content="P2" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_3" Content="P3" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_4" Content="P4" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_5" Content="P5" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_6" Content="P6" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="in_d_p_7" Content="P7" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                </StackPanel>
                                                <Label Content="Virtual"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <CheckBox x:Name="in_d_v_0" Content="V0" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_1" Content="V1" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_2" Content="V2" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_3" Content="V3" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_4" Content="V4" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_5" Content="V5" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_6" Content="V6" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="in_d_v_7" Content="V7" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical">
                                                <Button x:Name="in_add_p1" Content="Add In"  Width="100" Margin="5,20,0,0" Click="add_in_Click"/>
                                                <Button x:Name="in_add_p2" Content="Add In to All"  Width="100" Margin="5,20,0,0" Click="add_in_to_all_ports_Click"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>



                                    <Border  Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <StackPanel Orientation="Horizontal" >
                                            <StackPanel Orientation="Vertical" Width="160">
                                                <Label Content="Output Mapping (for LED's)"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Port"/>
                                                    <TextBox x:Name="out_add_port_num" Width="50" Text="0"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="VID "/>
                                                    <TextBox x:Name="out_add_VID" Width="50"  Text="0" ToolTip="0 for any HID device" TextChanged="add_VID_TextChanged"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="PID "/>
                                                    <TextBox x:Name="out_add_PID" Width="50"  Text="0" ToolTip="0 for any HID device" TextChanged="add_PID_TextChanged"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical" Width="190">
                                                <Label Content="Control Config"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Ctrl" Margin="0,0,3,0"/>
                                                    <TextBox x:Name="out_add_map_num" Width="50"  Text="0" ToolTip="Control number taken from HID data below" />
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                    <Label Content="Mode"/>
                                                    <ComboBox Name="map_add_out_mode" SelectedIndex="0">
                                                        <ComboBoxItem Content="Stage (C+S)"/>
                                                        <ComboBoxItem Content="Disable All (C+S)"/>
                                                        <ComboBoxItem Content="Toggle (C+S)"/>
                                                        <ComboBoxItem Content="Position 1 (C+S)"/>
                                                        <ComboBoxItem Content="Position 2 (C+S)"/>
                                                        <ComboBoxItem Content="Position 3 (C+S)"/>
                                                        <ComboBoxItem Content="Position 4 (C+S)"/>
                                                        <ComboBoxItem Content="Position 5 (C+S)"/>
                                                        <ComboBoxItem Content="Position 6 (C+S)"/>
                                                        <ComboBoxItem Content="Position 7 (C+S)"/>
                                                        <ComboBoxItem Content="Position 8 (C+S)"/>
                                                        <ComboBoxItem Content="Position 9 (C+S)"/>
                                                        <ComboBoxItem Content="Position 10 (C+S)"/>
                                                        <ComboBoxItem Content="Speed Switch (C+S)"/>
                                                        <ComboBoxItem Content="Stage (Inverted)" />
                                                        <ComboBoxItem/>
                                                    </ComboBox>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel Orientation="Vertical" Width="350">
                                                <Label Content="Color selection"/>
                                                <RichTextBox Height="166" Margin="10,0" VerticalScrollBarVisibility="Auto" Background="{x:Null}" Foreground="White">
                                                    <FlowDocument>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Stage: "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Limit (Blink color 1), Disabled (Solid color 1), Stopped (Solid color 2), Moving (Solid color 3)"/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Disable All: "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="All disabled (Solid color 1) or LED off"/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Toggle: "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span FontWeight="Normal">
                                                                <Run Text="(Position 1 (Solid color 1, Position 2 Solid color 2)"/>
                                                            </Span>
                                                            <Span>
                                                                <Run Text=" "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Position: "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span FontWeight="Normal">
                                                                <Run Text="At position (Solid color 1), not at position (Solid color 2)"/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Speed Switch: "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span FontWeight="Normal">
                                                                <Run Text="Original Speed (Solid color 1), Speed Switch (Solid color 2)"/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span>
                                                                <Run Text="Stage (inverted): "/>
                                                            </Span>
                                                        </Paragraph>
                                                        <Paragraph FontWeight="Bold" FontSize="10" FontFamily="Segoe UI" Margin="0" TextAlignment="Left">
                                                            <Span FontWeight="Normal">
                                                                <Run Text="Limit (Blink color 2), Disabled (Solid color 1), Stopped (Solid color 2), Moving (Solid color 3)"/>
                                                            </Span>
                                                        </Paragraph>
                                                    </FlowDocument>
                                                </RichTextBox>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Color 1" Margin="0,5,5,0"/>
                                                    <ComboBox Name="map_out_color_id_1" SelectedIndex="2"  Margin="0,5,5,5">
                                                        <ComboBoxItem Content="OFF"/>
                                                        <ComboBoxItem Content="White"/>
                                                        <ComboBoxItem Content="Red"/>
                                                        <ComboBoxItem Content="Green"/>
                                                        <ComboBoxItem Content="Blue"/>
                                                        <ComboBoxItem Content="Yellow"/>
                                                        <ComboBoxItem Content="Aqua"/>
                                                        <ComboBoxItem Content="Magenta"/>
                                                        <ComboBoxItem Content="Dim White"/>
                                                        <ComboBoxItem Content="Dim Red"/>
                                                        <ComboBoxItem Content="Dim Green"/>
                                                        <ComboBoxItem Content="Dim Blue"/>
                                                        <ComboBoxItem Content="Dim Yellow"/>
                                                        <ComboBoxItem Content="Dim Aqua"/>
                                                        <ComboBoxItem Content="Dim Magenta"/>
                                                        <ComboBoxItem/>
                                                    </ComboBox>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Color 2" Margin="0,5,5,0"/>
                                                    <ComboBox Name="map_out_color_id_2" SelectedIndex="3"  Margin="0,5,5,5">
                                                        <ComboBoxItem Content="OFF"/>
                                                        <ComboBoxItem Content="White"/>
                                                        <ComboBoxItem Content="Red"/>
                                                        <ComboBoxItem Content="Green"/>
                                                        <ComboBoxItem Content="Blue"/>
                                                        <ComboBoxItem Content="Yellow"/>
                                                        <ComboBoxItem Content="Aqua"/>
                                                        <ComboBoxItem Content="Magenta"/>
                                                        <ComboBoxItem Content="Dim White"/>
                                                        <ComboBoxItem Content="Dim Red"/>
                                                        <ComboBoxItem Content="Dim Green"/>
                                                        <ComboBoxItem Content="Dim Blue"/>
                                                        <ComboBoxItem Content="Dim Yellow"/>
                                                        <ComboBoxItem Content="Dim Aqua"/>
                                                        <ComboBoxItem Content="Dim Magenta"/>
                                                        <ComboBoxItem/>
                                                    </ComboBox>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label Content="Color 3" Margin="0,5,5,0"/>
                                                    <ComboBox Name="map_out_color_id_3" SelectedIndex="4"  Margin="0,5,5,5">
                                                        <ComboBoxItem Content="OFF"/>
                                                        <ComboBoxItem Content="White"/>
                                                        <ComboBoxItem Content="Red"/>
                                                        <ComboBoxItem Content="Green"/>
                                                        <ComboBoxItem Content="Blue"/>
                                                        <ComboBoxItem Content="Yellow"/>
                                                        <ComboBoxItem Content="Aqua"/>
                                                        <ComboBoxItem Content="Magenta"/>
                                                        <ComboBoxItem Content="Dim White"/>
                                                        <ComboBoxItem Content="Dim Red"/>
                                                        <ComboBoxItem Content="Dim Green"/>
                                                        <ComboBoxItem Content="Dim Blue"/>
                                                        <ComboBoxItem Content="Dim Yellow"/>
                                                        <ComboBoxItem Content="Dim Aqua"/>
                                                        <ComboBoxItem Content="Dim Magenta"/>
                                                        <ComboBoxItem/>
                                                    </ComboBox>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical">
                                                <Label Content="Source"/>
                                                <Label Content="Slot"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="out_d_s_0" Content="S0" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_1" Content="S1" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_2" Content="S2" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_3" Content="S3" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_4" Content="S4" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_5" Content="S5" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_6" Content="S6" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_s_7" Content="S7" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                </StackPanel>
                                                <Label Content="Bit (if a slot has multiple outputs like triggers or shutters)"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="out_d_b_0" Content="B0" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_1" Content="B1" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_2" Content="B2" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_3" Content="B3" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_4" Content="B4" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_5" Content="B5" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_6" Content="B6" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_b_7" Content="B7" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                </StackPanel>
                                                <Label Content="Port, Send data to USB devices connected to the controller"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox x:Name="out_d_p_0" Content="P0" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_1" Content="P1" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_2" Content="P2" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_3" Content="P3" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_4" Content="P4" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_5" Content="P5" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_6" Content="P6" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <CheckBox x:Name="out_d_p_7" Content="P7" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                </StackPanel>
                                                <Label Content="Virtual"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <CheckBox x:Name="out_d_v_0" Content="V0" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_1" Content="V1" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_2" Content="V2" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_3" Content="V3" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_4" Content="V4" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_5" Content="V5" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_6" Content="V6" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                    <CheckBox x:Name="out_d_v_7" Content="V7" VerticalAlignment="Center" Margin="0,0,11,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical">
                                                <Button x:Name="out_add_p1" Content="Add Out"  Width="100" Margin="5,20,0,0" Click="add_out_Click"/>
                                                <Button x:Name="out_add_p2" Content="Add Out to All"  Width="100" Margin="5,20,0,0" Click="add_out_to_all_ports_Click"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal" >
                                                <Label x:Name="p0" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p0" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p0" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p0" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_0" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_0" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical">
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p1" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="save_p1" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p1" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p1" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_1" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_1" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical">
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p2" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p2" Content="Save Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p2" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p2" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_2" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_2" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p3" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p3" Content="Save Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p3" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p3" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_3" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_3" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p4" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p4" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p4" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p4" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_4" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_4" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p5" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p5" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p5" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p5" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_5" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_5" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p6" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p6" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p6" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p6" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_6" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_6" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                    <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" >
                                        <WrapPanel Orientation="Vertical" >
                                            <WrapPanel Orientation="Horizontal">
                                                <Label x:Name="p7" Content="Port"/>
                                            </WrapPanel>
                                            <WrapPanel Orientation="Horizontal" >
                                                <Button x:Name="in_save_p7" Content="Save In Mapping Data"  Width="150" Margin="5,5,5,5" Click="in_save_Click"/>
                                                <Button x:Name="out_save_p7" Content="Save Out Mapping Data"  Width="150" Margin="5,5,5,5" Click="out_save_Click"/>
                                                <CheckBox x:Name="e_chk_usb_host_save_eeprom_p7" Content="Save to EEPROM" Margin="25,5,0,5" />
                                            </WrapPanel>
                                            <Label Content="In Mappings"/>
                                            <WrapPanel x:Name="map_7" Orientation="Vertical" Margin="5,5,5,5"/>
                                            <Label Content="Out Mappings"/>
                                            <WrapPanel x:Name="map_out_7" Orientation="Vertical" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <TabItem x:Name="Steppers" Header="Steppers">
                    <StackPanel>
                        <StackPanel Height="697">
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Select Slot:"/>
                                        <ComboBox x:Name="cb_stage_select" Margin="15,5,5,5" SelectionChanged="cb_stepper_select_SelectionChanged" Width="200">
                                            <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Button x:Name="bt_stepper_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="stepper_params_refresh_Click"/>
                                        <Button x:Name="bt_stepper_load_xml" Content="Load XML Defaults" Margin="5,5,5,5" Click="bt_stepper_load_xml_Click"/>
                                        <CheckBox x:Name="e_cbx_stepper_xml_persistent" Content="Load to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                        <Button x:Name="bt_stepper_erase_params" Content="Reset Parameters" Margin="40,5,5,5" Click="bt_stepper_erase_params_Click" />
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="[ Limit Parameters ]"/>
                                        <Label Content="CW Hard Limit:"/>
                                        <ComboBox x:Name="cb_cw_hardlimit" Margin="5,5,5,5" Width="190">
                                            <ComboBoxItem Content="Ignore or switch not present" />
                                            <ComboBoxItem Content="Switch makes on contact" />
                                            <ComboBoxItem Content="Switch breaks on contact" />
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Label Content="CCW Hard Limit: "/>
                                        <ComboBox x:Name="cb_ccw_hardlimit"  Margin="5,5,5,5"  Width="190">
                                            <ComboBoxItem Content="Ignore or switch not present" />
                                            <ComboBoxItem Content="Switch makes on contact" />
                                            <ComboBoxItem Content="Switch breaks on contact" />
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Label Content="Limit Mode: "/>
                                        <ComboBox x:Name="limit_mode"  Margin="5,5,5,5"  Width="190">
                                            <ComboBoxItem Content="Ignore Limit" />
                                            <ComboBoxItem Content="Stop Immediate at Limit" />
                                            <ComboBoxItem Content="Profiled Stop at limit" />
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <CheckBox x:Name = "Limit_swap" Content="Limit Swap" VerticalAlignment="Top" Margin="15,5,5,5" />
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="CCW Soft Limit: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tbCCW_soft_limit" Text="0" Width="100" Margin="5,5,5,5"/>
                                        <Label Content="CW Soft Limit: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tbCW_soft_limit" Text="0" Width="100" Margin="5,5,5,5"/>
                                        <Button x:Name="bt_clear_soft_limits" Content="Clear Soft Limits"  Width="100" Margin="5,5,5,5" Click="Clear_soft_limits_Click"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="ABS Low Limit:  " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_abs_low_limit" Text="0" Width="100" Margin="5,5,5,5"/>
                                        <Label Content="ABS Hi Limit:   " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_abs_high_limit" Text="0" Width="100" Margin="5,5,5,5"/>
                                        <Button x:Name="bt_set_abs_low_limits" Content="Set ABS Low Limit"  Width="100" Margin="5,5,5,5" Click="btn_set_abs_low_lim_Click"/>
                                        <Button x:Name="bt_set_abs_high_limits" Content="Set ABS Hi Limit"  Width="100" Margin="5,5,5,5" Click="btn_set_abs_high_lim_Click"/>
                                        <Button x:Name="bt_clear_abs_limits" Content="Clear ABS Limits"  Width="100" Margin="5,5,5,5" Click="btn_clear_abs_lim_Click"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Button x:Name="save_limits_params" Content="Save Limits Data"  Width="150" Margin="5,5,5,5" Click="Limits_save_Click"/>
                                        <CheckBox x:Name="e_cbx_limits_persistent" Content="Save to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="[ Home Parameters ]"/>
                                        <Label Content="Home Mode: "/>
                                        <ComboBox x:Name="cb_home_mode" Margin="5,5,5,5"  Width="140
                                                      ">
                                            <ComboBoxItem Content="Normal" />
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Label Content="Home Direction: "/>
                                        <ComboBox x:Name="cb_home_dir" Margin="5,5,5,5"  Width="140">
                                            <ComboBoxItem Content="Home CW" />
                                            <ComboBoxItem Content="Home CCW" />
                                            <ComboBoxItem Content="Home Index CW First"/>
                                            <ComboBoxItem Content="Home Index CCW First"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Label Content="Limit To Hit: "/>
                                        <ComboBox x:Name="cb_home_limit" Margin="5,5,5,5"  Width="140">
                                            <ComboBoxItem Content="Home to Index"/>
                                            <ComboBoxItem Content="Home to Limit"/>
                                            <ComboBoxItem Content="Home to Hard Stop"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Label Content="Home Velocity (%): "/>
                                        <TextBox x:Name="Home_vel" Text="100" ToolTip="0% to 100% of max speed" Width="30" Margin="5,5,5,5"/>
                                        <Label Content="Offset (um): "/>
                                        <TextBox x:Name="tb_home_offset" Text="" Width="80" Margin="5,5,5,5"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Button x:Name="save_Home_params" Content="Save Home Parameters"  Width="150" Margin="5,5,5,5" Click="Home_params_save_Click"/>
                                        <CheckBox x:Name="e_cbx_home_persistent" Content="Save to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="[ Stepper Drive Parameters ] "/>
                                        <Label Content="Stage Name: "/>
                                        <TextBox x:Name="tb_stage_name" Text="0000000000000000" Width="110" Margin="5,5,5,5" MaxLength="16"/>
                                        <Label Content="Stage ID: "/>
                                        <TextBox x:Name="tb_stage_id" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Holding Power: "/>
                                        <TextBox x:Name="tb_kval_hold" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Run Power: "/>
                                        <TextBox x:Name="tb_kval_run" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Counts/Unit: "/>
                                        <TextBox x:Name="tb_counts_per_unit" Text="" Width="120" Margin="5,5,5,5" ToolTip="Converts steeper counts to um"/>
                                        <Label Content="nm/Count: "/>
                                        <TextBox x:Name="tb_nm_per_count" Text="" Width="120" Margin="5,5,5,5" ToolTip="Converts encoder counts to um"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Max Acceleration: "/>
                                        <TextBox x:Name="tb_acc" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Max Deceleration: "/>
                                        <TextBox x:Name="tb_dec" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Max Velocity: "/>
                                        <TextBox x:Name="tb_max_speed" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Min Velocity: "/>
                                        <TextBox x:Name="tb_min_speed" Text="0" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="STALL TH: "/>
                                        <TextBox x:Name="tb_stall_th" Text="" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="OCD TH: "/>
                                        <TextBox x:Name="tb_ocd_th" Text="" Width="50" Margin="5,5,5,5"/>
                                        <Label Content="Config: "/>
                                        <TextBox x:Name="tb_config" Text="" Width="50" Margin="5,5,5,5"/>
                                        <Label Content="Step Mode: "/>
                                        <ComboBox x:Name="cb_step_mode" Margin="5,5,5,5">
                                            <ComboBoxItem Content="Full-Step"/>
                                            <ComboBoxItem Content="Half-Step"/>
                                            <ComboBoxItem Content="1/4 Microstep"/>
                                            <ComboBoxItem Content="1/8 Microstep"/>
                                            <ComboBoxItem Content="1/16 Microstep"/>
                                            <ComboBoxItem Content="1/32 Microstep"/>
                                            <ComboBoxItem Content="1/64 Microstep"/>
                                            <ComboBoxItem Content="1/128 Microstep"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="ST SLP: "/>
                                        <TextBox x:Name="tb_st_slp" Text="" Width="40" Margin="5,5,5,5" ToolTip="8 bits (0-255) default 41" />
                                        <Label Content="INT SPEED: "/>
                                        <TextBox x:Name="tb_int_speed" Text="" Width="40" Margin="5,5,5,5" ToolTip="14 bits (0-16398) default 1032"/>
                                        <Label Content="FN SLP ACC: "/>
                                        <TextBox x:Name="tb_fn_slp_acc" Text="" Width="40" Margin="5,5,5,5" ToolTip="8 bits (0-255) default 29"/>
                                        <Label Content="FN SLP DEC: "/>
                                        <TextBox x:Name="tb_fn_slp_dec" Text="" Width="40" Margin="5,5,5,5" ToolTip="8 bits (0-255) default 29"/>
                                        <Label Content="FS SPD:"/>
                                        <TextBox x:Name="tb_fs_spd" Text="" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Gate config:"/>
                                        <TextBox x:Name="tb_gate_config" Text="14680300" Width="60" Margin="5,5,5,5"/>
                                        <Label Content="Approach Speed:"/>
                                        <TextBox x:Name="tb_approach_vel" Text="1000" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Deadband:"/>
                                        <TextBox x:Name="tb_stepper_deadband" Text="0" ToolTip="0 for no deadband" Width="40" Margin="5,5,5,5"/>
                                        <Label Content="Backlash Comp:"/>
                                        <TextBox x:Name="tb_stepper_backlash" Text="0" ToolTip="0 for no backlash comp" Width="40" Margin="5,5,5,5"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Encoder Parameters: "/>
                                        <ComboBox x:Name="cb_encoder_type" Margin="5,5,5,5"  Width="240">
                                            <ComboBoxItem Content="None" />
                                            <ComboBoxItem Content="Quad Linear" />
                                            <ComboBoxItem Content="Absolute Index Linear"/>
                                            <ComboBoxItem Content="Absolute BISS Linear"/>
                                            <ComboBoxItem Content="Absolute Magnetic Rotation"/>
                                            <ComboBoxItem Content="Absolute Magnetic Rotation Auto Home"/>
                                            <ComboBoxItem Content="Absolute Magnetic Rotation LW"/>
                                            <ComboBoxItem Content="Absolute Magnetic Rotation Manual"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <CheckBox x:Name = "cb_has_encoder" Content="Has Encoder" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name = "cb_encoder_reverse" Content="Reverse Encoder" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name = "cb_has_index" Content="Has Index" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name = "cb_stepper_reverse" Content="Reverse Stepper" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name = "cb_use_PID" Content="Use PID" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name = "cb_PID_kickout" Content="PID Kickout" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <Label Content="Kickout time (10'sms)" />
                                        <TextBox x:Name="tb_kickout_time" Text="" Width="40" Margin="5,5,5,5" />
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Collision Threshold: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_collision_threshold" Text="0" Width="115" Margin="5,5,5,5" ToolTip="0 - ‭65535‬, 0 for no collision detection.  (in encoder counts)"/>
                                        <Label Content="Index Delta" />
                                        <TextBox x:Name="tb_index_delta" Text="" Width="50" Margin="5,5,5,5" />
                                        <Label Content="Index Increment" />
                                        <TextBox x:Name="tb_index_incr" Text="" Width="50" Margin="5,5,5,5" />
                                        <Label Content="Min Pos" />
                                        <TextBox x:Name="tb_min_pos" Text="" Width="50" Margin="5,5,5,5" />
                                        <Label Content="Max Pos" />
                                        <TextBox x:Name="tb_max_pos" Text="" Width="50" Margin="5,5,5,5" />
                                        <CheckBox x:Name="cb_is_rotational" Content="Is Rotational" VerticalAlignment="Top" Margin="15,5,5,5" />
                                        <CheckBox x:Name="cb_prefers_soft_stop" Content="Prefer Soft Stop" VerticalAlignment="Top" Margin="15,5,5,5" />
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Button x:Name="save_stepper_drive_params" Content="Save Drive Parameters"  Width="150" Margin="5,5,5,5" Click="stepper_drive_params_save_Click"/>
                                        <CheckBox x:Name="e_cbx_drive_persistent" Content="Save to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="[ PID Parameters ]"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Kp: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_p_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                        <Label Content="Ki: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_i_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                        <Label Content="Kd: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_d_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                        <Label Content="iMax: " Margin="5,0,0,0"/>
                                        <TextBox x:Name="tb_imax" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                        <Button x:Name="save_stepper_pid_params" Content="Save PID Parameters"  Width="150" Margin="5,5,5,5" Click="save_stepper_pid_params_Click" />
                                        <CheckBox x:Name="e_cbx_pid_persistent" Content="Save to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="[ Store Positions  (um)]"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Button x:Name="bt_clear_all_positions" Content="Clear All"  Width="150" Margin="5,5,5,5" Click="stepper_clear_all_position_Click"/>
                                        <Button x:Name="bt_save_all_positions" Content="Save All"  Width="150" Margin="5,5,5,5" Click="stepper_save_all_position_Click"/>
                                        <!--<CheckBox x:Name="e_cbx_store_persistent" Content="Save to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />-->
                                        <Label Margin="65,5,5,5" Content="Deadband:"/>
                                        <TextBox x:Name="tb_position_deadband" Text="0" ToolTip="0 for no deadband" Width="40" Margin="5,5,5,5"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="1 " Width="70" Margin="55,0,0,0"/>
                                        <Label Content="2 " Width="70" Margin="55,0,0,0"/>
                                        <Label Content="3 " Width="70" Margin="55,0,0,0"/>
                                        <Label Content="4 " Width="70" Margin="55,0,0,0"/>
                                        <Label Content="5 " Width="70" Margin="55,0,0,0"/>
                                        <Label Content="6 " Width="70" Margin="55,0,0,0"/>
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <TextBox x:Name="tb_pos_save_1" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                        <TextBox x:Name="tb_pos_save_2" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                        <TextBox x:Name="tb_pos_save_3" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                        <TextBox x:Name="tb_pos_save_4" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                        <TextBox x:Name="tb_pos_save_5" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                        <TextBox x:Name="tb_pos_save_6" Text="0" Width="115" Margin="5,5,5,5" GotKeyboardFocus="tb_GotKeyboardFocus" />
                                    </WrapPanel>
                                    <WrapPanel Orientation="Horizontal" >
                                        <Button x:Name="bt_copy_current_pos_1" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                        <Button x:Name="bt_copy_current_pos_2" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                        <Button x:Name="bt_copy_current_pos_3" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                        <Button x:Name="bt_copy_current_pos_4" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                        <Button x:Name="bt_copy_current_pos_5" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                        <Button x:Name="bt_copy_current_pos_6" Content="Copy Current Pos"  Width="115" Margin="5,5,5,5" PreviewMouseLeftButtonDown="bt_copy_current_pos_PreviewMouseLeftButtonDown" PreviewMouseLeftButtonUp="bt_copy_current_pos_PreviewMouseLeftButtonUp"/>
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="Servo" Header="Servo">
                    <StackPanel >
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot:"/>
                                    <ComboBox Name="cb_servo_select" Margin="15,5,5,5" SelectionChanged="cb_servo_select_SelectionChanged">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_servo_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_servo_params_refresh_Click"/>
                                    <Button x:Name="bt_servo_load_xml" Content="Load XML Defaults" Margin="5,5,5,5" Click="bt_servo_load_xml_Click"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>

                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Transit time(ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbServoTransit_time" Text="0" Width="115" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Speed(0-1024): " ToolTip="1024 gives the motor 12V" Margin="55,5,5,5"/>
                                    <TextBox Name="tbServoSpeed" Text="0" Width="115" Margin="5,5,5,5"></TextBox>
                                    <Button Name="SaveServoParams" Content="Save"  Click="save_servo_params_Click" Width="56" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="Shutter" Header="Shutter">
                    <StackPanel >
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot:"/>
                                    <ComboBox Name="cb_shutter_select" Margin="15,5,5,5" SelectionChanged="bt_shutter_params_refresh_Click">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_shutter_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_shutter_params_refresh_Click"/>
                                    <Button x:Name="bt_stutter_load_xml" Content="Load XML Defaults" Margin="5,5,5,5" Click="bt_shutter_load_xml_Click"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>

                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_sutter_initial_state" Margin="5,5,5,5" Width="72" MinWidth="70" >
                                        <ComboBoxItem Content="Open" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Closed" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter Mode:"/>
                                    <ComboBox Name="cb_sutter_mode" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Pluse" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Hold" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter External Trigger:"/>
                                    <ComboBox Name="cb_sutter_external_trigger_mode" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Enable" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Reverse" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Toggle" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Pulse time(10's of ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutterPulse_time" Text="0" Width="50" Margin="5,5,5,5" ToolTip="In 10's of ms"></TextBox>
                                    <Label Content="Pulse Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutterVoltage" Text="0" Width="50" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Hold Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutterHoldVoltage" Text="0" Width="50" Margin="5,5,5,5"></TextBox>
                                    <Button Name="SaveShutterParams" Content="Save"  Click="save_shutter_params_Click" Width="56" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="IO" Header="Slider IO">
                    <StackPanel >
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot:"/>
                                    <ComboBox Name="cb_io_select" Margin="15,5,5,5" SelectionChanged="bt_io_params_refresh_Click">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_io_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_io_params_refresh_Click"/>
                                    <Button x:Name="bt_slider_io_load_xml" Content="Load XML Defaults" Margin="5,5,5,5" Click="bt_slider_io_load_xml_Click"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Mirror Channel 1:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_mirror_initial_state_1" Margin="5,5,5,5" Width="72" MinWidth="100" >
                                        <ComboBoxItem Content="Mirror Out" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Mirror In" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Mode:"/>
                                    <ComboBox x:Name="cb_io_mode_1" Margin="5,5,5,5" Width="70" SelectionChanged="cb_io_mode_SelectionChanged" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Direct" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Signal" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Position"/>
                                    <Slider x:Name="mirror_position_1" Minimum="100" Maximum="200" Value="150" Width="150" SmallChange="1" AutoToolTipPlacement="TopLeft"  AutoToolTipPrecision="0" ValueChanged="mirror_position_1_ValueChanged"/>
                                    <Label Content="Mirror Value Low:"/>
                                    <TextBox x:Name="tb_io_mirror_low_val_1" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Label Content="Mirror Value High:"/>
                                    <TextBox x:Name="tb_io_mirror_high_val_1" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Button x:Name="Save_io_Params_1" Content="Save"  Click="save_io_params_Click" Width="56" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Mirror Channel 2:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_mirror_initial_state_2" Margin="5,5,5,5" Width="72" MinWidth="100" >
                                        <ComboBoxItem Content="Mirror Out" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Mirror In" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Mode:"/>
                                    <ComboBox x:Name="cb_io_mode_2" Margin="5,5,5,5" Width="70" SelectionChanged="cb_io_mode_SelectionChanged" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Direct" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Signal" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Position"/>
                                    <Slider x:Name="mirror_position_2" Minimum="100" Maximum="200" Value="150" Width="150" SmallChange="1" AutoToolTipPlacement="TopLeft"  AutoToolTipPrecision="0"/>
                                    <Label Content="Mirror Value Low:"/>
                                    <TextBox x:Name="tb_io_mirror_low_val_2" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Label Content="Mirror Value High:"/>
                                    <TextBox x:Name="tb_io_mirror_high_val_2" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Button x:Name="Save_io_Params_2" Content="Save"  Click="save_io_params_Click" Width="56" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Mirror Channel 3:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_mirror_initial_state_3" Margin="5,5,5,5" Width="72" MinWidth="100" >
                                        <ComboBoxItem Content="Mirror Out" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Mirror In" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Mode:"/>
                                    <ComboBox x:Name="cb_io_mode_3" Margin="5,5,5,5" Width="70" SelectionChanged="cb_io_mode_SelectionChanged" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Direct" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Signal" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Mirror Position"/>
                                    <Slider x:Name="mirror_position_3" Minimum="100" Maximum="200" Value="150" Width="150" SmallChange="1" AutoToolTipPlacement="TopLeft"  AutoToolTipPrecision="0"/>
                                    <Label Content="Mirror Value Low:"/>
                                    <TextBox x:Name="tb_io_mirror_low_val_3" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Label Content="Mirror Value High:"/>
                                    <TextBox x:Name="tb_io_mirror_high_val_3" Text="0" Width="50" Margin="5,5,5,5"/>
                                    <Button x:Name="Save_io_Params_3" Content="Save"  Click="save_io_params_Click" Width="56" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="Shutter_4" Header="4 Shutter">
                    <StackPanel >
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot:"/>
                                    <ComboBox Name="cb_shutter_4_select" Margin="15,5,5,5" SelectionChanged="bt_shutter_4_params_refresh_Click">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_shutter_4_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="bt_shutter_4_params_refresh_Click"/>
                                    <Button x:Name="bt_shutter_4_load_xml" Content="Load XML Defaults" Margin="5,5,5,5" Click="bt_shutter_4_load_xml_Click"/>
                                    <CheckBox x:Name="e_cbx_4_shutter_xml_persistent" Content="Load to EEPROM" VerticalAlignment="Center" Margin="5,5,5,5" />
                                </WrapPanel>
                            </WrapPanel>
                        </Border>

                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <StackPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Shutter Channel 1:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_shutter_4_initial_state_1" Margin="5,5,5,5" Width="72" MinWidth="70" >
                                        <ComboBoxItem Content="Open" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Closed" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter Mode:"/>
                                    <ComboBox Name="cb_shutter_4_mode_1" Margin="5,5,5,5" MinWidth="100" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Pluse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Hold" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="No Reverse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter External Trigger:"/>
                                    <ComboBox Name="cb_shutter_4_external_trigger_mode_1" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Enable" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Reverse" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Pulse time(10's of ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Pulse_time_1" Text="0"  Margin="5,5,5,5" ToolTip="In 10's of ms" Width="40"></TextBox>
                                    <Label Content="Pulse Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Voltage_1" Text="0"  Margin="5,5,5,5" Width="40"></TextBox>
                                    <Label Content="Hold Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_HoldVoltage_1" Text="0" Width="40" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Open Voltage is..." Margin="5" />
                                    <ComboBox x:Name="cb_shutter_4_voltage_reverse_1" Margin="5">
                                        <ComboBoxItem>Positive</ComboBoxItem>
                                        <ComboBoxItem>Negative</ComboBoxItem>
                                    </ComboBox>
                                    <Label Content="Actuation Holdoff (100s of ns)" Margin="5" />
                                    <TextBox Name="tbShutter_4_Holdoff_1" Text="0" Width="80" Margin="5,5,5,5"></TextBox>

                                </WrapPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="SaveShutter_4_Params_1" Content="Save"  Click="save_shutter_4_params_Click" Width="56" Margin="5,5,5,5"/>
                                    <CheckBox x:Name="e_chbx_4_shutter_persist_1" Content="Persist to EEPROM" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Shutter Channel 2:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_shutter_4_initial_state_2" Margin="5,5,5,5" Width="72" MinWidth="70" >
                                        <ComboBoxItem Content="Open" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Closed" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter Mode:"/>
                                    <ComboBox Name="cb_shutter_4_mode_2" Margin="5,5,5,5" MinWidth="100" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Pluse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Hold" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="No Reverse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter External Trigger:"/>
                                    <ComboBox Name="cb_shutter_4_external_trigger_mode_2" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Enable" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Reverse" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Pulse time(10's of ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Pulse_time_2" Text="0"  Margin="5,5,5,5" ToolTip="In 10's of ms" Width="40"></TextBox>
                                    <Label Content="Pulse Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Voltage_2" Text="0"  Margin="5,5,5,5" Width="40"></TextBox>
                                    <Label Content="Hold Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_HoldVoltage_2" Text="0" Width="40" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Open Voltage is..." Margin="5" />
                                    <ComboBox x:Name="cb_shutter_4_voltage_reverse_2" Margin="5">
                                        <ComboBoxItem>Positive</ComboBoxItem>
                                        <ComboBoxItem>Negative</ComboBoxItem>
                                    </ComboBox>
                                    <Label Content="Actuation Holdoff (100s of ns)" Margin="5" />
                                    <TextBox Name="tbShutter_4_Holdoff_2" Text="0" Width="80" Margin="5,5,5,5"></TextBox>
                                </WrapPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="SaveShutter_4_Params_2" Content="Save"  Click="save_shutter_4_params_Click" Width="56" Margin="5,5,5,5"/>
                                    <CheckBox x:Name="e_chbx_4_shutter_persist_2" Content="Persist to EEPROM" VerticalAlignment="Center"/>
                                </StackPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Shutter Channel 3:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_shutter_4_initial_state_3" Margin="5,5,5,5" Width="72" MinWidth="70" >
                                        <ComboBoxItem Content="Open" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Closed" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter Mode:"/>
                                    <ComboBox Name="cb_shutter_4_mode_3" Margin="5,5,5,5" MinWidth="100" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Pluse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="Hold" HorizontalAlignment="Left"/>
                                        <ComboBoxItem Content="No Reverse" HorizontalAlignment="Left"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter External Trigger:"/>
                                    <ComboBox Name="cb_shutter_4_external_trigger_mode_3" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Enable" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Reverse" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Pulse time(10's of ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Pulse_time_3" Text="0" Width="40" Margin="5,5,5,5" ToolTip="In 10's of ms"></TextBox>
                                    <Label Content="Pulse Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Voltage_3" Text="0" Width="40" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Hold Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_HoldVoltage_3" Text="0" Width="40" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Open Voltage is..." Margin="5" />
                                    <ComboBox x:Name="cb_shutter_4_voltage_reverse_3" Margin="5">
                                        <ComboBoxItem>Positive</ComboBoxItem>
                                        <ComboBoxItem>Negative</ComboBoxItem>
                                    </ComboBox>
                                    <Label Content="Actuation Holdoff (100s of ns)" Margin="5" />
                                    <TextBox Name="tbShutter_4_Holdoff_3" Text="0" Width="80" Margin="5,5,5,5"></TextBox>
                                </WrapPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="SaveShutter_4_Params_3" Content="Save"  Click="save_shutter_4_params_Click" Width="56" Margin="5,5,5,5"/>
                                    <CheckBox x:Name="e_chbx_4_shutter_persist_3" Content="Persist to EEPROM" VerticalAlignment="Center"/>
                                </StackPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Shutter Channel 4:"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal">
                                    <Label Content="Initial State:"/>
                                    <ComboBox Name="cb_shutter_4_initial_state_4" Margin="5,5,5,5" Width="72" MinWidth="70" >
                                        <ComboBoxItem Content="Open" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Closed" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter Mode:"/>
                                    <ComboBox Name="cb_shutter_4_mode_4" Margin="5,5,5,5" MinWidth="100" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Pluse" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="Hold" HorizontalAlignment="Left" />
                                        <ComboBoxItem Content="No Reverse" HorizontalAlignment="Left" />
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Shutter External Trigger:"/>
                                    <ComboBox Name="cb_shutter_4_external_trigger_mode_4" Margin="5,5,5,5" MinWidth="70" >
                                        <ComboBoxItem Content="Disabled" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Enable" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem Content="Reverse" HorizontalAlignment="Left" Width="50"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Label Content="Pulse time(10's of ms): " Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Pulse_time_4" Text="0" Width="40" Margin="5,5,5,5" ToolTip="In 10's of ms"></TextBox>
                                    <Label Content="Pulse Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_Voltage_4" Text="0" Width="38" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Hold Voltage(0-1900): " ToolTip="1900 gives the motor 12V" Margin="5,5,5,5"/>
                                    <TextBox Name="tbShutter_4_HoldVoltage_4" Text="0" Width="40" Margin="5,5,5,5"></TextBox>
                                    <Label Content="Open Voltage is..." Margin="5" />
                                    <ComboBox x:Name="cb_shutter_4_voltage_reverse_4" Margin="5">
                                        <ComboBoxItem>Positive</ComboBoxItem>
                                        <ComboBoxItem>Negative</ComboBoxItem>
                                    </ComboBox>
                                    <Label Content="Actuation Holdoff (100s of ns)" Margin="5" />
                                    <TextBox Name="tbShutter_4_Holdoff_4" Text="0" Width="80" Margin="5,5,5,5"></TextBox>
                                </WrapPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="SaveShutter_4_Params_4" Content="Save"  Click="save_shutter_4_params_Click" Width="56" Margin="5,5,5,5"/>
                                    <CheckBox x:Name="e_chbx_4_shutter_persist_4" Content="Persist to EEPROM" VerticalAlignment="Center"/>
                                </StackPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="Elliptec" Header="Elliptec">
                    <StackPanel >
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="Select Slot:"/>
                                    <ComboBox x:Name="cb_elliptec_select" Margin="15,5,5,5" SelectionChanged="cb_elliptec_select_SelectionChanged">
                                        <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="SLOT 8" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_elliptec_params_refresh" Content="Refresh"  Width="150" Margin="5,5,5,5" Click="cb_elliptec_select_SelectionChanged"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Button Name="elliptec_search_freq_m1" Content="Search Freq Motor 1" Width="120" Margin="5,5,5,5"/>
                                    <Button Name="elliptec_search_freq_m2" Content="Search Freq Motor 2" Width="120" Margin="5,5,5,5"/>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ Store Positions (um)]"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Button x:Name="bt_pe_clear_all_positions" Content="Clear All"  Width="150" Margin="5,5,5,5" Click="elliptec_clear_all_position_Click"/>
                                    <Button x:Name="bt_pe_save_all_positions" Content="Save All"  Width="150" Margin="5,5,5,5" Click="elliptec_save_all_position_Click"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="1 " Width="70" Margin="55,0,0,0"/>
                                    <Label Content="2 " Width="70" Margin="55,0,0,0"/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" >
                                    <TextBox Name="tb_pe_pos_save_1" Text="0" Width="115" Margin="5,5,5,5" ></TextBox>
                                    <TextBox Name="tb_pe_pos_save_2" Text="0" Width="115" Margin="5,5,5,5" ></TextBox>
                                </WrapPanel>
                            </WrapPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="Piezo_tab" Header="Piezo" Height="26" VerticalAlignment="Top">
                    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <StackPanel >
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <WrapPanel Orientation="Horizontal" >
                                        <Label Content="Select Slot:"/>
                                        <ComboBox Name="cb_piezo_select" Margin="15,5,5,5" Width="100" SelectionChanged="bt_piezo_params_refresh_Click">
                                            <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left"/>
                                            <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left"/>
                                            <ComboBoxItem/>
                                        </ComboBox>
                                        <Button x:Name="bt_piezo_load_xml" Content="Load XML Defaults" Margin="5,5,5,5"  Click="bt_piezo_load_xml_Click"/>
                                    </WrapPanel>
                                </WrapPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <StackPanel Orientation="Horizontal" >
                                    <StackPanel Orientation="Vertical" >
                                        <WrapPanel Orientation="Horizontal" >
                                            <Label Content="[ Slot Parameters ]"/>
                                            <Button x:Name="bt_piezo_params_refresh" Content="Refresh"  Width="80" Margin="5,5,5,5" Click="bt_piezo_params_refresh_Click"/>
                                            <Button Name="SavePiezo_Params" Content="Save"  Click="save_piezo_params_Click" Width="80" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                        <WrapPanel Orientation="Horizontal">
                                            <Label Content="Encoder Slot Number:"  />
                                            <ComboBox Name="cb_piezo_encoder_select" Margin="15,5,5,5" Width="65" >
                                                <ComboBoxItem Content="SLOT 1" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 2" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 3" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 4" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 5" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 6" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="SLOT 7" HorizontalAlignment="Left"/>
                                                <ComboBoxItem Content="No Slot" HorizontalAlignment="Left"/>
                                                <ComboBoxItem/>
                                            </ComboBox>
                                            <Label Content="Gain Factor: " Margin="5,0,0,0"/>
                                            <TextBox x:Name="tb_piezo_gain_factor" Text="1.0" Width="50" Margin="5,5,5,5" ToolTip="Range .20 to 1.6, 1.1 makes faster, .9 makes slower"/>
                                        </WrapPanel>
                                        <WrapPanel Orientation="Vertical">
                                            <WrapPanel Orientation="Horizontal" >
                                            </WrapPanel>
                                        </WrapPanel>
                                        <WrapPanel Orientation="Vertical">
                                            <WrapPanel Orientation="Horizontal" >
                                            </WrapPanel>
                                        </WrapPanel>

                                        <WrapPanel Orientation="Vertical">
                                        </WrapPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <StackPanel Orientation="Horizontal" >
                                    <StackPanel Orientation="Vertical" >
                                        <WrapPanel Orientation="Horizontal" >
                                            <Label Content="[ Slot Values ]"/>
                                            <Button x:Name="bt_piezo_values_refresh" Content="Refresh"  Width="80" Margin="15,5,5,5" Click="bt_piezo_values_refresh_Click" />
                                            <Label Content="|" Margin="5,0,0,0"/>
                                            <Label Content="Kp: " Margin="5,0,0,0"/>
                                            <TextBox x:Name="tb_piezo_p_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                            <Label Content="Ki: " Margin="5,0,0,0"/>
                                            <TextBox x:Name="tb_piezo_i_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                            <Label Content="Kd: " Margin="5,0,0,0"/>
                                            <TextBox x:Name="tb_piezo_d_term" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                            <Label Content="iMax: " Margin="5,0,0,0"/>
                                            <TextBox x:Name="tb_piezo_imax" Text="0" Width="115" Margin="5,5,5,5" ToolTip="Range 0 to 32767"/>
                                            <Button Name="SavePiezo_PID_Params" Content="Save"  Click="save_piezo_pid_params_Click" Width="80" Margin="5,5,5,5"/>
                                        </WrapPanel>
                                        <WrapPanel Orientation="Vertical">
                                            <WrapPanel Orientation="Horizontal" >
                                                <Label Content="Kp: " Margin="5,0,0,0"/>
                                                <TextBox x:Name="tb_piezo_kp" Text="0" Width="50" Margin="5,5,5,5" />
                                                <Label Content="|" Margin="5,0,0,0"/>
                                                <Label Content="Dsplacement Time (ms): " Margin="5,0,0,0"/>
                                                <TextBox x:Name="tb_piezo_displacement_time" Text="0" Width="50" Margin="5,5,5,5"/>
                                                <Label Content="Overshoot (um): " Margin="5,0,0,0"/>
                                                <TextBox x:Name="tb_piezo_overshoot" Text="0" Width="50" Margin="5,5,5,5"/>
                                                <Label Content="Overshoot duration(ms): " Margin="5,0,0,0"/>
                                                <TextBox x:Name="tb_piezo_overshoot_duration" Text="0" Width="50" Margin="5,5,5,5"/>
                                            </WrapPanel>
                                        </WrapPanel>
                                        <WrapPanel Orientation="Vertical">
                                        </WrapPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <StackPanel Orientation="Horizontal" >
                                    <StackPanel Orientation="Vertical" >
                                        <Label Content="[ Slot Actions ]"/>
                                        <StackPanel Orientation="Horizontal" >
                                            <Button x:Name="btPiezo_stop" Content="Stop"  Width="80
                                                " Margin="5,5,5,5" Click="btPiezo_stop_Click"/>
                                            <Button x:Name="btPiezo_anlog_input_mode" Content="Analog Input"  Width="80
                                                    " Margin="5,5,5,5" Click="btPiezo_anlog_input_Click"/>
                                            <Label Content="|" Margin="5,0,0,0"/>
                                            <Label Content="Set DAC Voltage (0-5): " Margin="5,5,5,5"/>
                                            <TextBox Name="tbDAC_Voltage" Text="0"  Margin="5,5,5,5" Width="30"></TextBox>
                                            <Button x:Name="btSetDac" Content="Set"  Width="50 " Margin="5,5,5,5" Click="btSetDac_Click"  />
                                            <Label Content="|" Margin="5,0,0,0"/>
                                            <Label Content="Move By(um): " Margin="5,5,5,5"/>
                                            <TextBox Name="tbPiezo_move_by" Text="0"  Margin="5,5,5,5" Width="50"></TextBox>
                                            <Button x:Name="btPiezo_move_by_minus" Content="-"  Width="20 " Margin="5,5,5,5" Click="btPiezo_move_by_minus_Click" />
                                            <Button x:Name="btPiezo_move_by_plus" Content="+"  Width="20 " Margin="0,5,5,5" Click="btPiezo_move_by_plus_Click" />
                                            <CheckBox x:Name = "cb_piezo_move_by_mode" Content="Controller/PID" VerticalAlignment="Top" Margin="5,10,5,5" ToolTip="Checked for PID mode" />
                                            <Label Content="|" Margin="5,0,0,0"/>
                                            <Button x:Name="btStepper_log_move_by_2" Content="Steeper Move"  Width="100 " Margin="5,5,5,5" Click="btStepper_log_move_by_2_Click"/>
                                            <TextBox x:Name="tbStepper_log_jog_2" Text="0" Width="70" Margin="5,5,5,5"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" >
                                            <Label Content="Plot Scroll Size:" Margin="5
                                               ,5,5,5"/>
                                            <Slider x:Name="sl_plot_scroll_size_piezo" Maximum="100000"  Margin="5,5,5,5" SmallChange="1" TickFrequency="0" Value="500" Minimum="1" ValueChanged="sl_piezo_plot_scroll_size_ValueChanged" LargeChange="100" Width="300"/>
                                            <Label Content="Plot Delta X (ms): " Margin="5,5,5,5"/>
                                            <TextBox Name="tbPiezo_delta_ms" Text="0"  Margin="5,5,5,5" Width="70"></TextBox>
                                            <Label Content="Plot Delta Y (um): " Margin="5,5,5,5"/>
                                            <TextBox Name="tbPiezo_delta_y" Text="0"  Margin="5,5,5,5" Width="70"></TextBox>
                                            <CheckBox x:Name = "cb_piezo_plot_enable" Content="Enable Plot" VerticalAlignment="Top" Margin="5,10,5,5" Click="cb_piezo_plot_enable_Click" />
                                            <Button x:Name="btZero" Content="Zero Plot"  Width="60 " Margin="5,5,5,5" Click="btZero_Click"  />
                                            <Button x:Name="Clear_Plot_piezo" Content="Clear Plot" Margin="5,5,5,5" Click="Clear_piezo_Plot_Click"/>
                                            <Button x:Name="Save_Plot_piezo" Content="Save Plot" Margin="5,5,5,5" Click="Save_piezo_Plot_Click"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                                <WrapPanel Orientation="Vertical" >
                                    <StackPanel>

                                        <s:SciChartSurface Name="SciF_piezo" PreviewMouseDown="Scs_OnMouseDown" Height="450" Width="1150" Margin="0,0,0,0">

                                            <s:SciChartSurface.RenderableSeries>
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_adc_Series" YAxisId="Axis_V"/>
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_enc_Series" YAxisId="Axis_um" />
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_enc_filtered_Series" YAxisId="Axis_um" />
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_dac_Series" YAxisId="Axis_V"/>
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_error_Series" YAxisId="Axis_error"/>
                                                <s:FastLineRenderableSeries x:Name="LineSeries_piezo_setpoint_Series" YAxisId="Axis_um"/>
                                            </s:SciChartSurface.RenderableSeries>

                                            <s:SciChartSurface.XAxis>
                                                <s:NumericAxis AxisTitle="Time (ms)" x:Name="xPiezoAxis">
                                                </s:NumericAxis>

                                            </s:SciChartSurface.XAxis>

                                            <s:SciChartSurface.YAxes>
                                                <s:NumericAxis Id="Axis_V"  AxisTitle="V" GrowBy=".1, .1"/>
                                                <!--AutoRange="Always" GrowBy=".1, .1"-->
                                                <s:NumericAxis Id="Axis_um" AxisTitle="um" AxisAlignment="Left" TextFormatting="0,0.000"/>
                                                <s:NumericAxis Id="Axis_error" AxisTitle="cnt" AxisAlignment="Left" TextFormatting="0,0"/>

                                            </s:SciChartSurface.YAxes>

                                            <s:SciChartSurface.ChartModifier>
                                                <s:ModifierGroup>
                                                    <!-- Allow drag to zoom on Left mouse -->
                                                    <s:RubberBandXyZoomModifier ExecuteOn="MouseLeftButton"
                                                 RubberBandFill="#33FFFFFF" RubberBandStroke="#AAFFFFFF"
                                                 RubberBandStrokeDashArray="2 2"/>
                                                    <!-- Allow pan on Right mouse drag -->
                                                    <s:ZoomPanModifier ExecuteOn="MouseRightButton" ClipModeX="None" />
                                                    <!-- Allow Dragging YAxis to Scale -->
                                                    <s:YAxisDragModifier AxisId="Axis_V"  DragMode="Scale"/>
                                                    <s:YAxisDragModifier AxisId="Axis_um"  DragMode="Scale"/>
                                                    <s:YAxisDragModifier AxisId="Axis_error"  DragMode="Scale"/>
                                                    <!-- Allow Dragging XAxis to Pan -->
                                                    <s:XAxisDragModifier DragMode="Pan"/>
                                                    <!-- Allow Mousewheel Zoom -->
                                                    <s:MouseWheelZoomModifier/>
                                                    <!-- Allow Zoom to Extents on double click -->
                                                    <s:ZoomExtentsModifier ExecuteOn="MouseDoubleClick" />
                                                    <!-- Add a Legend to the chart -->
                                                    <!-- where xmlns:s="http://schemas.abtsoftware.co.uk/scichart" -->
                                                    <s:LegendModifier Name="LogLeg_piezo" ShowLegend="True" Orientation="Vertical"
                                       VerticalAlignment="Top"                                     
                                       HorizontalAlignment="Left"
                                       LegendPlacement="Inside" />
                                                    <!-- Add a RolloverModifier to the chart (shows vertical line tooltips -->
                                                    <s:RolloverModifier IsEnabled="True" DrawVerticalLine="True" ShowTooltipOn="Always" SourceMode="AllSeries"/>

                                                </s:ModifierGroup>
                                            </s:SciChartSurface.ChartModifier>

                                        </s:SciChartSurface>
                                    </StackPanel>


                                </WrapPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <TabItem x:Name="efs_tab" Header="EFS">
                    <Grid Margin="5,5,5,5" Background="#FF333333" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Margin="5,10,10,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1" Grid.Column="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Identifier:  " />
                                    <Label x:Name="e_lbl_efs_identifier" />
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Version:  " />
                                    <Label x:Name="e_lbl_efs_version" />
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Page Size:  " />
                                    <Label x:Name="e_lbl_efs_page_size" />
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Packet Limit:  " />
                                    <Label x:Name="e_lbl_efs_packet_limit" />
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Pages Remaining:  " />
                                    <Label x:Name="e_lbl_efs_pages_remaining" Content="0" />
                                    <Label Content="/" />
                                    <Label x:Name="e_lbl_efs_total_pages" Content="0" />
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="5,5,5,5">
                                    <Label Content="Files Remaining:  " />
                                    <Label x:Name="e_lbl_efs_files_remaining" Content="0" />
                                    <Label Content="/" />
                                    <Label x:Name="e_lbl_efs_total_files" Content="0" />
                                </StackPanel>

                                <ProgressBar x:Name="e_pbr_efs_pages_remaining" Margin="5,5,5,5" Grid.Row="3" Grid.Column="0" Height="30"/>
                                <ProgressBar x:Name="e_pbr_efs_files_remaining" Margin="5,5,5,5" Grid.Row="3" Grid.Column="1" Height="30"/>

                            </Grid>
                        </Border>
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="300" />
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Margin="5,5,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="e_stk_efs_files">
                                        <Border BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                            <StackPanel Orientation="Horizontal">

                                                <Label Content="Identifier" Width="130"/>
                                                <Label Content="Size" Width="100"/>
                                                <Label Content="Attr.ER" Width="50"/>
                                                <Label Content="Attr.EW" Width="50"/>
                                                <Label Content="Attr.ED" Width="50"/>
                                                <Label Content="Attr.FR" Width="50"/>
                                                <Label Content="Attr.FW" Width="50"/>
                                                <Label Content="Attr.FD" Width="50"/>
                                                <Label Content="Owned" Width="50" />
                                                <Label Content="Download" Width="65" Margin="60,0,0,0"/>
                                                <Label Content="Refresh" Width="65" />
                                                <Label Content="Delete" Width="65" />
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                            <Border Grid.Column="1" Margin="5,5,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                <StackPanel>
                                    <Button Content="Refresh All Files" Width="100" Margin="5,5,5,5" Click="Button_EFSRefreshAll_Clicked"/>
                                    <Border Grid.Column="1" Margin="5,5,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                        <StackPanel>
                                            <Label Content="Upload a File" FontSize="16"/>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="Extension" Width="60"/>
                                                <ComboBox x:Name="e_cbx_efs_selected_extension" Margin="5,5,5,5" Width="200">
                                                    <ComboBoxItem Content="LUT" />
                                                    <ComboBoxItem Content="User" />
                                                </ComboBox>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="ID" Width="60"/>
                                                <TextBox x:Name="e_tbx_efs_selected_id" Margin="5,5,5,5" Width="50" MaxLength="3" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="External Permissions" Width="130" />
                                                <CheckBox x:Name="e_chk_efs_selected_er" Margin="5,5,5,5" Content="R" IsChecked="True" />
                                                <CheckBox x:Name="e_chk_efs_selected_ew" Margin="5,5,5,5" Content="W" IsChecked="True" />
                                                <CheckBox x:Name="e_chk_efs_selected_ed" Margin="5,5,5,5" Content="D" IsChecked="True" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="Firmware Permissions" Width="130"/>
                                                <CheckBox x:Name="e_chk_efs_selected_fr" Margin="5,5,5,5" Content="R" />
                                                <CheckBox x:Name="e_chk_efs_selected_fw" Margin="5,5,5,5" Content="W" />
                                                <CheckBox x:Name="e_chk_efs_selected_fd" Margin="5,5,5,5" Content="D" />
                                            </StackPanel>
                                            <Button Content="Browse and Upload" Click="Button_EFSUpload_Clicked" Margin="5,5,5,5" />
                                        </StackPanel>
                                    </Border>
                                    <Border Grid.Column="1" Margin="5,5,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                        <Grid Margin="5,5,5,5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox x:Name="e_chk_lut_locked" Content="LUTs Locked" IsChecked="True"/>
                                            <Button Grid.Column="2" Content="Send" Click="Button_lut_locked_Clicked" />
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem x:Name="ow_tab" Header="One-Wire">
                    <Grid Margin="5,5,5,5" Background="#FF333333" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="5*"/>
                                <ColumnDefinition Width="5*"/>
                            </Grid.ColumnDefinitions>
                            <Border  Margin="15,10,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Content="[ Device Selection ]"/>
                                        <ComboBox x:Name="ow_device_select" MinWidth="250" Margin="5">
                                            <ComboBoxItem Content="Slot 1" IsSelected="True" />
                                            <ComboBoxItem Content="Slot 2" />
                                            <ComboBoxItem Content="Slot 3" />
                                            <ComboBoxItem Content="Slot 4" />
                                            <ComboBoxItem Content="Slot 5" />
                                            <ComboBoxItem Content="Slot 6" />
                                            <ComboBoxItem Content="Slot 7" />
                                            <ComboBoxItem Content="Slot 8" />
                                        </ComboBox>
                                        <Button Content="Refresh" Margin="5,5,5,5" Click="ow_refresh_Clicked"/>
                                        <Label x:Name="ow_device_select_details" Content="" Background="{x:Null}" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                        <Grid Grid.Row="1" Margin="5, 10, 5, 10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Column="0" Grid.Row="0" Margin="5,0,5,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Border Grid.Column="0" Grid.Row="0" Margin="5,0,5,0" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                    <StackPanel>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Content="[ Device Signature ]"/>
                                            <Label Content="Slot Type:" Margin="30,0,0,0" Grid.Column="1" />
                                            <Label x:Name="ow_unique_slot_type" Content="" MinWidth="200" Grid.Column="2"/>
                                            <Label Content="Device ID:" Margin="10,0,0,0" Grid.Column="3" />
                                            <Label x:Name="ow_unique_device_type" Content="0x0000" Width="50" Grid.Column="4"/>

                                            <Label Content="[ Read Device Signature ]" Grid.Row="1"/>
                                            <Label Content="Slot Type:" Margin="30,0,0,0" Grid.Row="1" Grid.Column="1" />
                                            <Label x:Name="ow_read_slot_type" Content="" MinWidth="200" Grid.Row="1" Grid.Column="2"/>
                                            <Label Content="Device ID:" Margin="10,0,0,0" Grid.Row="1" Grid.Column="3" />
                                            <Label x:Name="ow_read_device_type" Content="0x0000" Width="50" Grid.Row="1" Grid.Column="4"/>
                                            <Label Content="Identifier:" Margin="10,0,0,0" Grid.Row="1" Grid.Column="5" />
                                            <Label x:Name="ow_read_device_name" Content="" Grid.Row="1" Grid.Column="6" />

                                            <Label Content="OW Serial No.:" Grid.Row="2" Grid.Column="1" />
                                            <Label x:Name="ow_read_serial_number" Grid.Row="2" Grid.Column="2" />
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Column="0" Grid.Row="1" Margin="5,10,5,0" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <StackPanel Orientation="Horizontal">
                                            <Label Content="[ One-Wire Configuration ]" />
                                            <Label Margin="40,0,0,0" Content="Mode:" />
                                            <ComboBox Margin="10,2,0,1"
                                                      Width="100"
                                                      SelectedIndex="0"
                                                      SelectionChanged="OneWireVersionSelectionChanged">
                                                <ComboBoxItem>v2</ComboBoxItem>
                                                <ComboBoxItem>1:1</ComboBoxItem>
                                                <ComboBoxItem>system</ComboBoxItem>
                                            </ComboBox>
                                        </StackPanel>

                                        <ContentPresenter x:Name="e_cpr_one_wire_config"
                                                          Grid.Row="1">
                                            <d:ContentPresenter.Content>
                                                <controls:OneWireConfigurationV2>
                                                    <controls:OneWireConfigurationV2.DataContext>
                                                        <builders:OneWireV2BuilderViewModel />
                                                    </controls:OneWireConfigurationV2.DataContext>
                                                </controls:OneWireConfigurationV2>
                                            </d:ContentPresenter.Content>
                                        </ContentPresenter>

                                    </Grid>
                                </Border>
                            </Grid>
                            <Border Grid.Column="1" Grid.Row="0" Margin="5,0,5,0" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                <StackPanel>
                                    <Border Margin="5,5,5,5" BorderThickness="1,1,1,1" BorderBrush="White" CornerRadius="1,1,1,1">
                                        <StackPanel Orientation="Horizontal">
                                            <Label Content="Status:" />
                                            <Label x:Name="ow_status" Content="No device connected." Width="200"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                            <StackPanel Grid.Column="0" Grid.Row="1" Margin="5,0,5,0">

                            </StackPanel>
                            <Grid Grid.Row="1" Grid.Column="1" Margin="5,10,5,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Button x:Name="e_btn_ow_execute" Content="PROGRAM" FontSize="18"
                                        Grid.Column="2" />
                            </Grid>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem Name="system_tab" Header="System">
                    <StackPanel>
                        <Border BorderBrush="White" BorderThickness="1" Margin="5,5,5,5" >
                            <StackPanel  Orientation ="Horizontal">
                                <Button Name="btSuspendTask" Content="Suspend All Task" Click="SuspendTask_Click" Margin="5,5,5,5"/>
                                <Button Name="btResumeTask" Content="Resume All Task" Click="ResumeTask_Click" Margin="5,5,5,5"/>
                                <Button x:Name="btResumeTask_Copy" Content="Restart Processor" Click="Restart_processor_Click" Margin="5,5,5,5"/>
                                <Button x:Name="btRefresh_system_tab" Content="Refresh Page" Click="system_tab_refresh_page_Click" Margin="750,5,5,5"/>
                            </StackPanel>
                        </Border>
                        <Border BorderBrush="White" BorderThickness="1" Margin="5,5,5,5"  >
                            <StackPanel  Orientation ="Horizontal">
                                <Label Name="lbl_tem_status" Content="Temerature"  Width="800" />
                            </StackPanel>
                        </Border>
                        <Border BorderBrush="White" BorderThickness="1" Margin="5,5,5,5"  >
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Board Configuration:" Margin="5,0,0,0"/>
                                    <ComboBox x:Name="cbBoardType" MinWidth="250" Margin="5"/>
                                    <Button Name="btSetBoard" Content="Set Board Type" Click="Set_board_type_Click" Margin="5,5,5,5"/>
                                    <Button x:Name="btEraseEEPROM" Content="Erase EEPROM" Click="erase_eeprom_Click" Margin="5,5,5,5"/>
                                    <TextBlock MaxWidth="200" TextWrapping="Wrap" Margin="5,2,5,2" FontSize="10">
                                        CPLD must be programmed before board configuraiton can be set.
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" >
                                    <Label Content="Serial Number:" Margin="0,5,0,5" />
                                    <TextBox x:Name="e_tbx_system_serial_number" Width="130" MaxLength="17" Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_number" Content="Set Serial Number" Margin="10,5,5,5" Click="e_btn_system_serial_number_Click" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        <Border BorderBrush="White" BorderThickness="1" Margin="5,5,5,5" >
                            <StackPanel  Orientation ="Vertical">
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="[ Slot Configuration ]" Margin="5,5,5,5"/>
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 1 card type:"/>
                                    <ComboBox x:Name="cbcardType_1" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_1" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_1" Margin="5,5,5,5" Width="30" Content="Set" Click="Set_card_type_Click"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_1" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_1" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_1" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_1" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_1" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 2 card type:"/>
                                    <ComboBox x:Name="cbcardType_2" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_2" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_2" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_2" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_2" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_2" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_2" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_2" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 3 card type:"/>
                                    <ComboBox x:Name="cbcardType_3" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_3" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_3" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_3" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_3" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_3" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_3" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_3" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 4 card type:"/>
                                    <ComboBox x:Name="cbcardType_4" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_4" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_4" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_4" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_4" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_4" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_4" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_4" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 5 card type:"/>
                                    <ComboBox x:Name="cbcardType_5" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_5" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_5" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_5" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_5" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_5" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_5" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_5" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 6 card type:"/>
                                    <ComboBox x:Name="cbcardType_6" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_6" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_6" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_6" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_6" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_6" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_6" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_6" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 7 card type:"/>
                                    <ComboBox x:Name="cbcardType_7" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_7" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_7" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_7" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_7" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_7" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_7" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_7" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>
                                <StackPanel  Orientation ="Horizontal">
                                    <Label Content="Slot 8 card type:"/>
                                    <ComboBox x:Name="cbcardType_8" Margin="15,5,5,5" Width="200"/>
                                    <CheckBox x:Name = "cb_slot_static_8" Content="Static" VerticalAlignment="Top" Margin="0,10,5,5" />
                                    <Button x:Name="btSetCardType_8" Content="Set" Click="Set_card_type_Click" Margin="5,5,5,5" Width="30"/>
                                    <Label Content="|  Allowed Devices: " Margin="0,5,0,5"/>
                                    <Button x:Name="btChangeAllowedDevices_8" Content="Change Allowed Devices" Click="View_allowed_devices" Margin="5,5,5,5" Width="140"/>
                                    <Label Content="|  " Margin="0,5,0,5" />
                                    <Button x:Name="e_btn_system_serial_lock_8" Content="Disable S.N. Protection" Margin="5,5,5,5" Width="130" Click="Button_system_disable_sn_protect_Clicked"/>
                                    <TextBox x:Name="e_tbx_system_protected_sn_8" Text="0xFFFFFFFFFFFF" Width="90" Margin="5,5,5,5" />
                                    <Button x:Name="e_btn_system_set_locked_sn_8" Content="Set" Margin="5,5,5,5" Width="25" Click="system_set_sn" />
                                    <Label Content="|  Disable Device Detection:" Margin="5,5,0,5"/>
                                    <CheckBox x:Name="cbDisableDeviceDetection_8" HorizontalAlignment="Center" VerticalAlignment="Center" Click="DisableDD_Clicked" />
                                </StackPanel>

                            </StackPanel>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ Set Defaults ]"/>
                                    <Label x:Name="lb_load_xml_status" Content=""/>
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" Grid.Row="1" >
                                    <Label Content="System" Margin="5,0,0,0" Width="50"/>
                                    <Button x:Name="bt_load_xml" Content="Load XML Defaults" Click="Load_XML_Click" Margin="5,5,5,5"/>

                                    <CheckBox x:Name="e_cbx_xml_load_slots" Content="Slot Type" VerticalAlignment="Top" IsChecked="True" Margin="5,8,5,5" ToolTip="Programs the identifier chips on the slot cards." />
                                    <CheckBox x:Name="e_cbx_xml_load_allowed_devices" Content="Allowed Devices" VerticalAlignment="Top" IsChecked="True" Margin="5,8,5,5" ToolTip="Sets the allowed devices for each slot card." />
                                    <CheckBox x:Name="e_cbx_xml_load_lut" Content="LUTs" VerticalAlignment="Top" IsChecked="True" Margin="5,8,5,5" ToolTip="Programs all of the look-up tables for the device." />
                                    <CheckBox x:Name="e_cbx_xml_load_joystick" Content="Joystick Config" VerticalAlignment="Top" IsChecked="True" Margin="5,8,5,5" ToolTip="Programs all of the joystick mappings for the device." />
                                </WrapPanel>
                                <WrapPanel Orientation="Horizontal" Grid.Column="2" Grid.Row="1" Margin="0,0,10,0">
                                    <Label Content="Joystick Port" Margin="0,0,0,0" Width="100"/>
                                    <ComboBox x:Name="cb_js_port" Margin="5,5,5,5" Width="100" SelectedIndex="0">
                                        <ComboBoxItem Content="Port 0" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 1" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 2" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 3" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 4" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 5" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 6" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem Content="Port 7" HorizontalAlignment="Left" Width="177"/>
                                        <ComboBoxItem/>
                                    </ComboBox>
                                    <Button x:Name="bt_load_joystick_xml" Content="Load Joystick XML Defaults" Click="bt_joystick_load_xml_Click" Margin="5,5,5,5"/>
                                    <CheckBox x:Name="e_chk_system_save_js" Content="Save to EEPROM" VerticalAlignment="Center" />
                                </WrapPanel>
                                <StackPanel Grid.Row="2" Orientation="Horizontal" Grid.ColumnSpan="3" >
                                    <Label Content="Programming File" />
                                    <Button Content="Browse" Width="50" Margin="5" Click="BrowseProgrammingFileClicked"/>
                                    <TextBox x:Name="e_tbx_progf_path" Margin="5" Width="300" IsEnabled="False" />
                                    <Label Content="Updates:" Margin="40,0,0,0" />
                                    <UniformGrid Columns="3">
                                        <CheckBox x:Name="e_cbx_progf_firmware" Content="Firmware" IsEnabled="False" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                        <CheckBox x:Name="e_cbx_progf_cpld" Content="CPLD" IsEnabled="False" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                        <CheckBox x:Name="e_cbx_progf_lut" Content="LUT" IsEnabled="False" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    </UniformGrid>
                                </StackPanel>

                            </Grid>
                        </Border>
                        <Border Margin="5,5,5,5" BorderBrush="White" BorderThickness="1">
                            <WrapPanel Orientation="Vertical" >
                                <WrapPanel Orientation="Horizontal" >
                                    <Label Content="[ System ]"/>
                                </WrapPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="System Dim (0 to 100%)" Margin="0,0,10,0"/>
                                    <Slider x:Name="system_dim_value" Minimum="1" Maximum="100" Value="100" Width="150" ValueChanged="system_dim_value_ValueChanged"/>
                                    <CheckBox x:Name = "cb_enable_logging" Content="Enable Logging" VerticalAlignment="Top" Margin="30,5,5,5" Checked="cb_enable_logging_Updated" Unchecked="cb_enable_logging_Updated"/>
                                </StackPanel>
                            </WrapPanel>
                        </Border>
                        <Border BorderBrush="White" BorderThickness="1" Margin="5,4,5,5">
                            <StackPanel  Orientation ="Horizontal">
                                <Border Width="588" BorderBrush="White" BorderThickness="1">
                                    <StackPanel  Orientation ="Vertical">
                                        <StackPanel  Orientation ="Horizontal" Width="550">
                                            <Label Content="[ Firmware Updater ]" Width="150" />
                                        </StackPanel>
                                        <StackPanel  Orientation ="Horizontal" Width="550">
                                            <Button Name="btEnter_Exit_BootLoader" Width="120" Content="Enter Bootloader" Click="btnEnter_Exit_bootloader_Click" Margin="5,5,5,5"/>
                                            <Label x:Name="labelFirmware_rev_val" Content="Bootloader Version: " Width="150" />
                                            <Button x:Name="btn_select_firmware_file" Content="Load Programming File" Margin="5,5,5,5" Width="140" Click="btn_select_firmware_file_Click"
                                                    IsEnabled="False" />
                                        </StackPanel>
                                        <StackPanel  Orientation ="Horizontal" Width="550" >
                                            <ProgressBar x:Name="pbar" Margin="5,5,5,5" HorizontalAlignment="Left" Minimum="0" Maximum="100" Background="#FF808080" Foreground="#FFFFFFFF" IsIndeterminate="False" Height="25" Width="252" VerticalAlignment="Top" />
                                            <Label x:Name="lbl1pbar" Margin="5,0,10,0" HorizontalAlignment="Left" VerticalAlignment="Center" HorizontalContentAlignment="Center" Content="0%" Foreground="#FFFFFFFF" Width="42" />
                                            <Label x:Name="lbl_con_status1" Content="Program Status" Margin="5,5,5,5" Width="178" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border Width="588" BorderBrush="White" BorderThickness="1">
                                    <StackPanel  Orientation ="Vertical">
                                        <StackPanel  Orientation ="Horizontal" Width="550">
                                            <Label Content="[ CPLD Updater ]" Width="150" />
                                        </StackPanel>
                                        <StackPanel  Orientation ="Horizontal" Width="550">
                                            <Button Name="btOpen_cpld_file" Width="140" Content="Load Programming File" Click="btOpen_cpld_file_Click" Margin="5,5,5,5"
                                                    IsEnabled="False" />
                                        </StackPanel>
                                        <StackPanel  Orientation ="Horizontal" Width="550" >
                                            <ProgressBar x:Name="pbar_cpld" Margin="5,5,5,5" HorizontalAlignment="Left" Minimum="0" Maximum="100" Background="#FF808080" Foreground="#FFFFFFFF" IsIndeterminate="False" Height="25" Width="252" VerticalAlignment="Top" />
                                            <Label x:Name="lbl1pbar_cpld" Margin="5,0,10,0" HorizontalAlignment="Left" VerticalAlignment="Center" HorizontalContentAlignment="Center" Content="0%" Foreground="#FFFFFFFF" Width="42" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </TabItem>
            </TabControl>
        </StackPanel>
    </Grid>
</Window>

    